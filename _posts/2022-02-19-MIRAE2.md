---
layout: single
title:  "[2021 미래에셋 빅데이터 페스티벌] 02. 데이터 전처리, 그 위대한 여정"
categories: Project
tag: [미래에셋증권, 공모전, AI서비스, 클러스터링, Data Preprocessing]
toc: true
author_profile: false
---




# 1. 사용환경 설정 및 데이터 불러오기



```python
import pandas as pd
import os
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
```


```python
os.chdir('C:\\Users')
```


```python
!pip install tqdm

from tqdm import tqdm
```

<pre>
Requirement already satisfied: tqdm in c:\users\choij\anaconda3\lib\site-packages (4.59.0)
</pre>

```python
df = pd.read_csv("미래에셋증권_공모전데이터.csv")
```

<pre>
C:\Users\choij\anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3165: DtypeWarning: Columns (3,4,22,33,34,35,39,40,41,45,46,47,61,62,80,91,92,93,97,98,99,103,104,105,119,120,138,149,150,151,155,156,157,161,162,163,177,178,196,207,208,209,213,214,215,219,220,221,235,236,254,265,266,267,271,272,273,277,278,279,293,294,312,323,324,325,329,330,331,335,336,337,351,352,370,381,382,383,387,388,389,393,394,395,409,410,428,439,440,441,445,446,447,451,452,453,467,468,486,497,498,499,503,504,505,509,510,511,525,526,544,555,556,557,561,562,563,567,568,569,583,584,602,613,614,615,619,620,621,625,626,627,641,642,660,671,672,673,677,678,679,683,684,685) have mixed types.Specify dtype option on import or set low_memory=False.
  has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
</pre>

```python
df.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>성별</th>
      <th>연령</th>
      <th>최초계좌개설일</th>
      <th>고객등급_202105</th>
      <th>주거래상품_202105</th>
      <th>주거래매체_202105</th>
      <th>국내주식자산_202105</th>
      <th>해외주식자산_202105</th>
      <th>상품자산_202105</th>
      <th>보유종목수_202105</th>
      <th>...</th>
      <th>Dr.Big의국내주식_202006</th>
      <th>Dr.Big의해외주식_202006</th>
      <th>Dr.Big의국내ETF_202006</th>
      <th>Dr.Big의펀드연금_202006</th>
      <th>Dr.Big의투자진단_202006</th>
      <th>Dr.Big의시그널_202006</th>
      <th>뉴스로종목포착_202006</th>
      <th>해외ETF트렌드_202006</th>
      <th>초고수의선택_202006</th>
      <th>주간상품TOP10_202006</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>20대이하</td>
      <td>200604.0</td>
      <td>A</td>
      <td>펀드</td>
      <td>2</td>
      <td>81000000.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>20대이하</td>
      <td>200610.0</td>
      <td>A</td>
      <td>주식</td>
      <td>2</td>
      <td>18000000.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>6.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>60대이상</td>
      <td>200001.0</td>
      <td>D</td>
      <td>주식</td>
      <td>2</td>
      <td>39000000.0</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>60대이상</td>
      <td>200001.0</td>
      <td>S</td>
      <td>주식</td>
      <td>1</td>
      <td>150000000.0</td>
      <td>0.000000e+00</td>
      <td>2.700000e+09</td>
      <td>17.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>60대이상</td>
      <td>200001.0</td>
      <td>V</td>
      <td>주식</td>
      <td>1</td>
      <td>290000000.0</td>
      <td>2.500000e+09</td>
      <td>9.900000e+10</td>
      <td>11.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 699 columns</p>
</div>



```python
df.shape
```

<pre>
(1499992, 699)
</pre>

```python
df.isnull().sum()
```

<pre>
성별                   0
연령                   0
최초계좌개설일              0
고객등급_202105          0
주거래상품_202105         0
                    ..
Dr.Big의시그널_202006    0
뉴스로종목포착_202006       0
해외ETF트렌드_202006      0
초고수의선택_202006        0
주간상품TOP10_202006     0
Length: 699, dtype: int64
</pre>

```python
df = df.sample(n=300000, replace=False, random_state=1)

print(df.shape)
```

<pre>
(300000, 699)
</pre>

```python
df.to_csv('df_sample.csv')
```

# 2. 항목별 데이터 전처리 및 내보내기


## 2.1. daytrading, swing, hold 비중


### 2.1.1. daytrading, swing, hold 데이터 추출



```python
day_trading1 = df[[f'DayTrading비중_20200{i}' for i in range(6,10)]]
day_trading2 = df[[f'DayTrading비중_2020{i}' for i in range(10,13)]]
day_trading3 = df[[f'DayTrading비중_20210{i}' for i in range(1,6)]]

day_trading = pd.concat([day_trading1, day_trading2, day_trading3], axis=1)

for i in day_trading:
    day_trading.loc[:,i] = pd.to_numeric(day_trading.loc[:,i])

day_trading.columns = ['daytradingRate_2006', 'daytradingRate_2007', 'daytradingRate_2008', 'daytradingRate_2009',
                'daytradingRate_2010', 'daytradingRate_2011', 'daytradingRate_2012', 'daytradingRate_2101',
                'daytradingRate_2102', 'daytradingRate_2103', 'daytradingRate_2104', 'daytradingRate_2105']
day_trading.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>daytradingRate_2006</th>
      <th>daytradingRate_2007</th>
      <th>daytradingRate_2008</th>
      <th>daytradingRate_2009</th>
      <th>daytradingRate_2010</th>
      <th>daytradingRate_2011</th>
      <th>daytradingRate_2012</th>
      <th>daytradingRate_2101</th>
      <th>daytradingRate_2102</th>
      <th>daytradingRate_2103</th>
      <th>daytradingRate_2104</th>
      <th>daytradingRate_2105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>11.0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>18.0</td>
      <td>25.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
swing1 = df[[f'Swing비중_20200{i}' for i in range(6,10)]]
swing2 = df[[f'Swing비중_2020{i}' for i in range(10,13)]]
swing3 = df[[f'Swing비중_20210{i}' for i in range(1,6)]]

swing = pd.concat([swing1, swing2, swing3], axis=1)

for i in swing:
    swing.loc[:,i] = pd.to_numeric(swing.loc[:,i])

swing.columns = ['swingRate_2006', 'swingRate_2007', 'swingRate_2008', 'swingRate_2009',
                'swingRate_2010', 'swingRate_2011', 'swingRate_2012', 'swingRate_2101',
                'swingRate_2102', 'swingRate_2103', 'swingRate_2104', 'swingRate_2105']
swing.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>swingRate_2006</th>
      <th>swingRate_2007</th>
      <th>swingRate_2008</th>
      <th>swingRate_2009</th>
      <th>swingRate_2010</th>
      <th>swingRate_2011</th>
      <th>swingRate_2012</th>
      <th>swingRate_2101</th>
      <th>swingRate_2102</th>
      <th>swingRate_2103</th>
      <th>swingRate_2104</th>
      <th>swingRate_2105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>91.0</td>
      <td>92.0</td>
      <td>84.0</td>
      <td>87.0</td>
      <td>83.0</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>79.0</td>
      <td>74.0</td>
      <td>69.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>99.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
hold1 = df[[f'Buy&Hold비중_20200{i}' for i in range(6,10)]]
hold2 = df[[f'Buy&Hold비중_2020{i}' for i in range(10,13)]]
hold3 = df[[f'Buy&Hold비중_20210{i}' for i in range(1,6)]]

hold = pd.concat([hold1, hold2, hold3], axis=1)

for i in hold:
    hold.loc[:,i] = pd.to_numeric(hold.loc[:,i])

hold.columns = ['holdRate_2006', 'holdRate_2007', 'holdRate_2008', 'holdRate_2009',
                'holdRate_2010', 'holdRate_2011', 'holdRate_2012', 'holdRate_2101',
                'holdRate_2102', 'holdRate_2103', 'holdRate_2104', 'holdRate_2105']
hold.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>holdRate_2006</th>
      <th>holdRate_2007</th>
      <th>holdRate_2008</th>
      <th>holdRate_2009</th>
      <th>holdRate_2010</th>
      <th>holdRate_2011</th>
      <th>holdRate_2012</th>
      <th>holdRate_2101</th>
      <th>holdRate_2102</th>
      <th>holdRate_2103</th>
      <th>holdRate_2104</th>
      <th>holdRate_2105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


* 보너스 - 사용자별 dt/sw/h 비중 시각화



```python
# n번째 사용자의 day trading/swing/hold 비중 시각화
n = 5

a = day_trading.iloc[n,:]
b = swing.iloc[n,:]
c = hold.iloc[n,:]

a.index = ['202006', '202007', '202008', '202009','202010', '202011', '202012', '202101','202102', '202103', '202104', '202105']
b.index = ['202006', '202007', '202008', '202009','202010', '202011', '202012', '202101','202102', '202103', '202104', '202105']
c.index = ['202006', '202007', '202008', '202009','202010', '202011', '202012', '202101','202102', '202103', '202104', '202105']

plt.plot(a)
plt.plot(b)
plt.plot(c)

plt.legend(['Day Trading', 'Swing', 'Hold'])
plt.show()
```

<img src="data:image/png;base64,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"/>

### 2.1.2. 주식 거래 패턴



```python
order_pattern = pd.concat([day_trading, swing, hold], axis=1)
```


```python
"""
order_pattern.to_csv('order_pattern.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\norder_pattern.to_csv('order_pattern.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.2. 국내/해외 주식자산 비중


### 2.2.1. 국내주식자산, 해외주식자산 데이터 추출



```python
in_stock_value1 = df[[f'국내주식자산_20200{i}' for i in range(6,10)]]
in_stock_value2 = df[[f'국내주식자산_2020{i}' for i in range(10,13)]]
in_stock_value3 = df[[f'국내주식자산_20210{i}' for i in range(1,6)]]

in_stock_value = pd.concat([in_stock_value1, in_stock_value2, in_stock_value3], axis=1)
for i in in_stock_value:
    in_stock_value.loc[:,i] = pd.to_numeric(in_stock_value.loc[:,i])
    
in_stock_value.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>국내주식자산_202006</th>
      <th>국내주식자산_202007</th>
      <th>국내주식자산_202008</th>
      <th>국내주식자산_202009</th>
      <th>국내주식자산_202010</th>
      <th>국내주식자산_202011</th>
      <th>국내주식자산_202012</th>
      <th>국내주식자산_202101</th>
      <th>국내주식자산_202102</th>
      <th>국내주식자산_202103</th>
      <th>국내주식자산_202104</th>
      <th>국내주식자산_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>230000.0</td>
      <td>4900000.0</td>
      <td>440000.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>1300000.0</td>
      <td>0.0</td>
      <td>1000000.0</td>
      <td>1000000.0</td>
      <td>990000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1400000.0</td>
      <td>1400000.0</td>
      <td>13000000.0</td>
      <td>110000000.0</td>
      <td>14000000.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
ab_stock_value1 = df[[f'해외주식자산_20200{i}' for i in range(6,10)]]
ab_stock_value2 = df[[f'해외주식자산_2020{i}' for i in range(10,13)]]
ab_stock_value3 = df[[f'해외주식자산_20210{i}' for i in range(1,6)]]

ab_stock_value = pd.concat([ab_stock_value1, ab_stock_value2, ab_stock_value3], axis=1)
for i in ab_stock_value:
    ab_stock_value.loc[:,i] = pd.to_numeric(ab_stock_value.loc[:,i])
    
ab_stock_value.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>해외주식자산_202006</th>
      <th>해외주식자산_202007</th>
      <th>해외주식자산_202008</th>
      <th>해외주식자산_202009</th>
      <th>해외주식자산_202010</th>
      <th>해외주식자산_202011</th>
      <th>해외주식자산_202012</th>
      <th>해외주식자산_202101</th>
      <th>해외주식자산_202102</th>
      <th>해외주식자산_202103</th>
      <th>해외주식자산_202104</th>
      <th>해외주식자산_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.2.2. 국내/해외 주식자산 비중 계산


국내 주식자산 비중 = (국내주식자산/총 주식자산)*100



해외 주식자산 비중 = (해외주식자산/총 주식자산)*100



```python
date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
in_s_rate = pd.DataFrame()
ab_s_rate = pd.DataFrame()

for i in date_range:
    a = in_stock_value[f'국내주식자산_202{i}']
    b = ab_stock_value[f'해외주식자산_202{i}']
    stock_value = pd.concat([a,b], axis = 1)
    total_stock_value = stock_value.sum(axis = 1)
    stock_value[f'총주식자산_202{i}'] = total_stock_value
    in_rate = (stock_value[f'국내주식자산_202{i}'] / stock_value[f'총주식자산_202{i}']) * 100
    ab_rate = (stock_value[f'해외주식자산_202{i}'] / stock_value[f'총주식자산_202{i}']) * 100
    in_s_rate = pd.concat([in_s_rate, in_rate], axis = 1)
    ab_s_rate = pd.concat([ab_s_rate, ab_rate], axis = 1)
    
in_s_rate.columns = ['in_s_rate_202006', 'in_s_rate_202007', 'in_s_rate_202008', 'in_s_rate_202009','in_s_rate_202010', 'in_s_rate_202011', 'in_s_rate_202012', 'in_s_rate_202101','in_s_rate_202102', 'in_s_rate_202103', 'in_s_rate_202104', 'in_s_rate_202105']
in_s_rate = in_s_rate.fillna(0)
ab_s_rate.columns = ['ab_s_rate_202006', 'ab_s_rate_202007', 'ab_s_rate_202008', 'ab_s_rate_202009','ab_s_rate_202010', 'ab_s_rate_202011', 'ab_s_rate_202012', 'ab_s_rate_202101','ab_s_rate_202102', 'ab_s_rate_202103', 'ab_s_rate_202104', 'ab_s_rate_202105']
ab_s_rate = ab_s_rate.fillna(0)
```


```python
in_s_rate.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>in_s_rate_202006</th>
      <th>in_s_rate_202007</th>
      <th>in_s_rate_202008</th>
      <th>in_s_rate_202009</th>
      <th>in_s_rate_202010</th>
      <th>in_s_rate_202011</th>
      <th>in_s_rate_202012</th>
      <th>in_s_rate_202101</th>
      <th>in_s_rate_202102</th>
      <th>in_s_rate_202103</th>
      <th>in_s_rate_202104</th>
      <th>in_s_rate_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>100.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
ab_s_rate.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ab_s_rate_202006</th>
      <th>ab_s_rate_202007</th>
      <th>ab_s_rate_202008</th>
      <th>ab_s_rate_202009</th>
      <th>ab_s_rate_202010</th>
      <th>ab_s_rate_202011</th>
      <th>ab_s_rate_202012</th>
      <th>ab_s_rate_202101</th>
      <th>ab_s_rate_202102</th>
      <th>ab_s_rate_202103</th>
      <th>ab_s_rate_202104</th>
      <th>ab_s_rate_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.2.3. 국내/해외 주식시장 비중



```python
in_ab_srate = pd.concat([in_s_rate, ab_s_rate], axis=1)
```


```python
"""
in_ab_srate.to_csv('in_ab_srate.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nin_ab_srate.to_csv('in_ab_srate.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.3. 국내/해외주식 집중도



### 2.3.1. 국내/해외주식 매수/매도 데이터 추출



```python
in_stock_buy1 = df[[f'국내주식매수_20200{i}' for i in range(6,10)]]
in_stock_buy2 = df[[f'국내주식매수_2020{i}' for i in range(10,13)]]
in_stock_buy3 = df[[f'국내주식매수_20210{i}' for i in range(1,6)]]

in_stock_buy = pd.concat([in_stock_buy1, in_stock_buy2, in_stock_buy3], axis=1)
for i in in_stock_buy:
    in_stock_buy.loc[:,i] = pd.to_numeric(in_stock_buy.loc[:,i])
    
in_stock_buy.head()
```


```python
in_stock_sell1 = df[[f'국내주식매도_20200{i}' for i in range(6,10)]]
in_stock_sell2 = df[[f'국내주식매도_2020{i}' for i in range(10,13)]]
in_stock_sell3 = df[[f'국내주식매도_20210{i}' for i in range(1,6)]]

in_stock_sell = pd.concat([in_stock_sell1, in_stock_sell2, in_stock_sell3], axis=1)
for i in in_stock_sell:
    in_stock_sell.loc[:,i] = pd.to_numeric(in_stock_sell.loc[:,i])
    
in_stock_sell.head()
```


```python
ab_stock_buy1 = df[[f'해외주식매수_20200{i}' for i in range(6,10)]]
ab_stock_buy2 = df[[f'해외주식매수_2020{i}' for i in range(10,13)]]
ab_stock_buy3 = df[[f'해외주식매수_20210{i}' for i in range(1,6)]]

ab_stock_buy = pd.concat([ab_stock_buy1, ab_stock_buy2, ab_stock_buy3], axis=1)
for i in ab_stock_buy:
    ab_stock_buy.loc[:,i] = pd.to_numeric(ab_stock_buy.loc[:,i])
    
ab_stock_buy.head()
```


```python
ab_stock_sell1 = df[[f'해외주식매도_20200{i}' for i in range(6,10)]]
ab_stock_sell2 = df[[f'해외주식매도_2020{i}' for i in range(10,13)]]
ab_stock_sell3 = df[[f'해외주식매도_20210{i}' for i in range(1,6)]]

ab_stock_sell = pd.concat([ab_stock_sell1, ab_stock_sell2, ab_stock_sell3], axis=1)
for i in ab_stock_sell:
    ab_stock_sell.loc[:,i] = pd.to_numeric(ab_stock_sell.loc[:,i])
    
ab_stock_sell.head()
```

### 2.3.2. 국내/해외주식 집중도 계산


국내주식집중도 = (국내주식매수+국내주식매도)/국내주식자산



해외주식집중도 = (해외주식매수+해외주식매도)/해외주식자산



```python
date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
in_stock_con = pd.DataFrame()

for i in date_range:
    a = in_stock_buy[f'국내주식매수_202{i}']
    b = in_stock_sell[f'국내주식매도_202{i}']
    in_stock_order = pd.concat([a,b], axis = 1)
    in_stock_order_sum = in_stock_order.sum(axis = 1)
    in_stock_order[f'국내주식주문합_202{i}'] = in_stock_order_sum
    in_stock_order_con = in_stock_order_sum / in_stock_value[f'국내주식자산_202{i}']
    in_stock_con = pd.concat([in_stock_con, in_stock_order_con], axis = 1)
    
in_stock_con.columns = ['in_stock_con_202006', 'in_stock_con_202007', 'in_stock_con_202008', 'in_stock_con_202009','in_stock_con_202010', 'in_stock_con_202011', 'in_stock_con_202012', 'in_stock_con_202101','in_stock_con_202102', 'in_stock_con_202103', 'in_stock_con_202104', 'in_stock_con_202105']
in_stock_con = in_stock_con.fillna(0)

in_stock_con.head()
```


```python
date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
ab_stock_con = pd.DataFrame()

for i in date_range:
    a = ab_stock_buy[f'해외주식매수_202{i}']
    b = ab_stock_sell[f'해외주식매도_202{i}']
    ab_stock_order = pd.concat([a,b], axis = 1)
    ab_stock_order_sum = ab_stock_order.sum(axis = 1)
    ab_stock_order[f'해외주식주문합_202{i}'] = ab_stock_order_sum
    ab_stock_order_con = ab_stock_order_sum / ab_stock_value[f'해외주식자산_202{i}']
    ab_stock_con = pd.concat([ab_stock_con, ab_stock_order_con], axis = 1)
    
ab_stock_con.columns = ['ab_stock_con_202006', 'ab_stock_con_202007', 'ab_stock_con_202008', 'ab_stock_con_202009','ab_stock_con_202010', 'ab_stock_con_202011', 'ab_stock_con_202012', 'ab_stock_con_202101','ab_stock_con_202102', 'ab_stock_con_202103', 'ab_stock_con_202104', 'ab_stock_con_202105']
ab_stock_con = ab_stock_con.fillna(0)

ab_stock_con.head()
```


```python
date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
in_s_con_rate = pd.DataFrame()
ab_s_con_rate = pd.DataFrame()

for i in date_range:
    a = in_stock_con[f'in_stock_con_202{i}']
    b = ab_stock_con[f'ab_stock_con_202{i}']
    stock_con = pd.concat([a,b], axis = 1)
    total_stock_con = stock_con.sum(axis = 1)
    stock_con[f'total_stock_con_202{i}'] = total_stock_con
    in_rate = (in_stock_con[f'in_stock_con_202{i}'] / stock_con[f'total_stock_con_202{i}']) * 100
    ab_rate = (ab_stock_con[f'ab_stock_con_202{i}'] / stock_con[f'total_stock_con_202{i}']) * 100
    in_s_con_rate = pd.concat([in_s_con_rate, in_rate], axis = 1)
    ab_s_con_rate = pd.concat([ab_s_con_rate, ab_rate], axis = 1)
    
column_name = 'in_s_con_rate'

in_s_con_rate.columns = [f'{column_name}_202006', f'{column_name}_202007', f'{column_name}_202008', f'{column_name}_202009',f'{column_name}_202010', f'{column_name}_202011', f'{column_name}_202012', f'{column_name}_202101', f'{column_name}_202102', f'{column_name}_202103', f'{column_name}_202104', f'{column_name}_202105']
in_s_con_rate = in_s_con_rate.fillna(0)

column_name = 'ab_s_con_rate'

ab_s_con_rate.columns = [f'{column_name}_202006', f'{column_name}_202007', f'{column_name}_202008', f'{column_name}_202009',f'{column_name}_202010', f'{column_name}_202011', f'{column_name}_202012', f'{column_name}_202101', f'{column_name}_202102', f'{column_name}_202103', f'{column_name}_202104', f'{column_name}_202105']
ab_s_con_rate = ab_s_con_rate.fillna(0)
```


```python
in_s_con_rate.head()
```


```python
ab_s_con_rate.head()
```

### 2.3.3. 국내/해외주식 집중도



```python
in_ab_conrate = pd.concat([in_s_con_rate, ab_s_con_rate], axis=1)
```


```python
"""
in_ab_conrate.to_csv('in_ab_conrate.csv', sep=',', encoding='utf-8')
"""
```

## 2.4. 주식 거래 활발도

: 거래종목수


### 2.4.1. 거래종목수 데이터 추출



```python
stock_order_n1 = df[[f'거래종목수_20200{i}' for i in range(6,10)]]
stock_order_n2 = df[[f'거래종목수_2020{i}' for i in range(10,13)]]
stock_order_n3 = df[[f'거래종목수_20210{i}' for i in range(1,6)]]

stock_order_n = pd.concat([stock_order_n1, stock_order_n2, stock_order_n3], axis=1)
for i in stock_order_n:
    stock_order_n.loc[:,i] = pd.to_numeric(stock_order_n.loc[:,i])
    
stock_order_n.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>거래종목수_202006</th>
      <th>거래종목수_202007</th>
      <th>거래종목수_202008</th>
      <th>거래종목수_202009</th>
      <th>거래종목수_202010</th>
      <th>거래종목수_202011</th>
      <th>거래종목수_202012</th>
      <th>거래종목수_202101</th>
      <th>거래종목수_202102</th>
      <th>거래종목수_202103</th>
      <th>거래종목수_202104</th>
      <th>거래종목수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>8.0</td>
      <td>3.0</td>
      <td>11.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>13.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.4.2. 주식 거래 활발도



```python
activity = stock_order_n.copy()

date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
activity.columns = [f'활발도_202{i}' for i in date_range]
```


```python
"""
activity.to_csv('activity.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nactivity.to_csv('activity.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.5. 포트폴리오 다양성

: 거래종목수 + 보유종목수


### 2.5.1. 거래종목수, 보유종목수 데이터 추출



```python
stock_order_n.shape
```

<pre>
(300000, 12)
</pre>

```python
stock_order_n.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>거래종목수_202006</th>
      <th>거래종목수_202007</th>
      <th>거래종목수_202008</th>
      <th>거래종목수_202009</th>
      <th>거래종목수_202010</th>
      <th>거래종목수_202011</th>
      <th>거래종목수_202012</th>
      <th>거래종목수_202101</th>
      <th>거래종목수_202102</th>
      <th>거래종목수_202103</th>
      <th>거래종목수_202104</th>
      <th>거래종목수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>8.0</td>
      <td>3.0</td>
      <td>11.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>13.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
column_name = '보유종목수'

stock_hold_n1 = df[[f'{column_name}_20200{i}' for i in range(6,10)]]
stock_hold_n2 = df[[f'{column_name}_2020{i}' for i in range(10,13)]]
stock_hold_n3 = df[[f'{column_name}_20210{i}' for i in range(1,6)]]

stock_hold_n = pd.concat([stock_hold_n1, stock_hold_n2, stock_hold_n3], axis=1)
for i in stock_hold_n:
    stock_hold_n.loc[:,i] = pd.to_numeric(stock_hold_n.loc[:,i])
    
stock_hold_n.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>보유종목수_202006</th>
      <th>보유종목수_202007</th>
      <th>보유종목수_202008</th>
      <th>보유종목수_202009</th>
      <th>보유종목수_202010</th>
      <th>보유종목수_202011</th>
      <th>보유종목수_202012</th>
      <th>보유종목수_202101</th>
      <th>보유종목수_202102</th>
      <th>보유종목수_202103</th>
      <th>보유종목수_202104</th>
      <th>보유종목수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.5.2. 포트폴리오 다양성



```python
date_range = ['006', '007', '008', '009', '010', '011', '012', '101', '102', '103', '104', '105']
stock_n = pd.DataFrame()

for i in date_range:
    a = stock_order_n[f'거래종목수_202{i}']
    b = stock_hold_n[f'보유종목수_202{i}']
    stock_total_n = pd.concat([a,b], axis = 1)
    stock_n_sum = stock_total_n.sum(axis = 1)
    stock_total_n[f'총종목수_202{i}'] = stock_n_sum
    stock_n = pd.concat([stock_n, stock_total_n[f'총종목수_202{i}']], axis = 1)
    
stock_n.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총종목수_202006</th>
      <th>총종목수_202007</th>
      <th>총종목수_202008</th>
      <th>총종목수_202009</th>
      <th>총종목수_202010</th>
      <th>총종목수_202011</th>
      <th>총종목수_202012</th>
      <th>총종목수_202101</th>
      <th>총종목수_202102</th>
      <th>총종목수_202103</th>
      <th>총종목수_202104</th>
      <th>총종목수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>17.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>19.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
"""
stock_n.to_csv('stock_n.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nstock_n.to_csv('stock_n.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.6. 매체 이용 성향

: m.Gobal 대비 m.Stock 접속 비중


### 2.6.1. m.stock/m.global 접속일수 데이터 추출



```python
stock1 = df[[f'm.Stock_접속일수_20200{i}' for i in range(6,10)]]
stock2 = df[[f'm.Stock_접속일수_2020{i}' for i in range(10,13)]]
stock3 = df[[f'm.Stock_접속일수_20210{i}' for i in range(1,6)]]

mstock = pd.concat([stock1, stock2, stock3], axis=1)
for i in mstock:
    mstock.loc[:,i] = pd.to_numeric(mstock.loc[:,i])
    
mstock.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>m.Stock_접속일수_202006</th>
      <th>m.Stock_접속일수_202007</th>
      <th>m.Stock_접속일수_202008</th>
      <th>m.Stock_접속일수_202009</th>
      <th>m.Stock_접속일수_202010</th>
      <th>m.Stock_접속일수_202011</th>
      <th>m.Stock_접속일수_202012</th>
      <th>m.Stock_접속일수_202101</th>
      <th>m.Stock_접속일수_202102</th>
      <th>m.Stock_접속일수_202103</th>
      <th>m.Stock_접속일수_202104</th>
      <th>m.Stock_접속일수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>23.0</td>
      <td>16.0</td>
      <td>23.0</td>
      <td>19.0</td>
      <td>14.0</td>
      <td>17.0</td>
      <td>24.0</td>
      <td>18.0</td>
      <td>17.0</td>
      <td>20.0</td>
      <td>23.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.0</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
global1 = df[[f'm.Global_접속일수_20200{i}' for i in range(6,10)]]
global2 = df[[f'm.Global_접속일수_2020{i}' for i in range(10,13)]]
global3 = df[[f'm.Global_접속일수_20210{i}' for i in range(1,6)]]

mglobal = pd.concat([global1, global2, global3], axis=1)

for i in mglobal:
    mglobal.loc[:,i] = pd.to_numeric(mglobal.loc[:,i])
    
mglobal.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>m.Global_접속일수_202006</th>
      <th>m.Global_접속일수_202007</th>
      <th>m.Global_접속일수_202008</th>
      <th>m.Global_접속일수_202009</th>
      <th>m.Global_접속일수_202010</th>
      <th>m.Global_접속일수_202011</th>
      <th>m.Global_접속일수_202012</th>
      <th>m.Global_접속일수_202101</th>
      <th>m.Global_접속일수_202102</th>
      <th>m.Global_접속일수_202103</th>
      <th>m.Global_접속일수_202104</th>
      <th>m.Global_접속일수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.6.2. m.stock/m.global 접속 비중 계산



```python
stock_global = pd.DataFrame(index = range(0, len(df)), columns = [])
for i in range(0,12):
    stock_global[i] = mstock.iloc[:, i]/(mstock.iloc[:, i] + mglobal.iloc[:, i])

stock_global.fillna(0, inplace=True)

stock_global.head(10)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.857143</td>
      <td>0.74359</td>
      <td>0.763158</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>


### 2.6.3. m.stock/m.global 접속정도



```python
colname = 'm.Stock접속비중'
stock_global.columns = [f'{colname}_202006', f'{colname}_202007', f'{colname}_202008', f'{colname}_202009',
                       f'{colname}_202010', f'{colname}_202011', f'{colname}_202012', f'{colname}_202101',
                       f'{colname}_202102', f'{colname}_202103', f'{colname}_202104', f'{colname}_202105']
```


```python
"""
stock_global.to_csv('stock_global_rate.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nstock_global.to_csv('stock_global_rate.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.7. 선호시장


### 2.7.1. 선호시장 데이터 추출



```python
prefer1 = df[[f'선호시장_20200{i}' for i in range(6,10)]]
prefer2 = df[[f'선호시장_2020{i}' for i in range(10,13)]]
prefer3 = df[[f'선호시장_20210{i}' for i in range(1,6)]]

prefer = pd.concat([prefer1, prefer2, prefer3], axis=1)

prefer.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선호시장_202006</th>
      <th>선호시장_202007</th>
      <th>선호시장_202008</th>
      <th>선호시장_202009</th>
      <th>선호시장_202010</th>
      <th>선호시장_202011</th>
      <th>선호시장_202012</th>
      <th>선호시장_202101</th>
      <th>선호시장_202102</th>
      <th>선호시장_202103</th>
      <th>선호시장_202104</th>
      <th>선호시장_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
      <td>코스피</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>코스피</td>
      <td>코스피</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.7.2. 선호시장 인코딩

0 : 누락 및 미기입 / 1 : 코스피 / 2 : 코스닥 / 3 : 시장전체



```python
prefer_changedict = {'코스피':1, '코스닥':2, '시장전체':3}
prefer = prefer.replace(prefer_changedict)

for i in prefer:
    prefer.loc[:,i] = pd.to_numeric(prefer.loc[:,i])
    
prefer.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>선호시장_202006</th>
      <th>선호시장_202007</th>
      <th>선호시장_202008</th>
      <th>선호시장_202009</th>
      <th>선호시장_202010</th>
      <th>선호시장_202011</th>
      <th>선호시장_202012</th>
      <th>선호시장_202101</th>
      <th>선호시장_202102</th>
      <th>선호시장_202103</th>
      <th>선호시장_202104</th>
      <th>선호시장_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



```python
"""
prefer.to_csv('prefer.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nprefer.to_csv('prefer.csv', sep=',', encoding='utf-8')\n"
</pre>

```python
# prefer_rowcount = prefer.apply(lambda s: s.value_counts(), axis=1).fillna(0)
```


```python
# prefer_rowcount
```

## 2.8. 이익실현, 손절 비중


### 2.8.1. 이익실현횟수, 손절횟수 데이터 추출



```python
profit1 = df[[f'이익실현횟수_20200{i}' for i in range(6,10)]]
profit2 = df[[f'이익실현횟수_2020{i}' for i in range(10,13)]]
profit3 = df[[f'이익실현횟수_20210{i}' for i in range(1,6)]]

profit = pd.concat([profit1, profit2, profit3], axis=1)
for i in profit:
    profit.loc[:,i] = pd.to_numeric(profit.loc[:,i])

profit.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이익실현횟수_202006</th>
      <th>이익실현횟수_202007</th>
      <th>이익실현횟수_202008</th>
      <th>이익실현횟수_202009</th>
      <th>이익실현횟수_202010</th>
      <th>이익실현횟수_202011</th>
      <th>이익실현횟수_202012</th>
      <th>이익실현횟수_202101</th>
      <th>이익실현횟수_202102</th>
      <th>이익실현횟수_202103</th>
      <th>이익실현횟수_202104</th>
      <th>이익실현횟수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>13.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>15.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>19.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
loss1 = df[[f'손절횟수_20200{i}' for i in range(6,10)]]
loss2 = df[[f'손절횟수_2020{i}' for i in range(10,13)]]
loss3 = df[[f'손절횟수_20210{i}' for i in range(1,6)]]

loss = pd.concat([loss1, loss2, loss3], axis=1)
for i in loss:
    loss.loc[:,i] = pd.to_numeric(loss.loc[:,i])
    
loss.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>손절횟수_202006</th>
      <th>손절횟수_202007</th>
      <th>손절횟수_202008</th>
      <th>손절횟수_202009</th>
      <th>손절횟수_202010</th>
      <th>손절횟수_202011</th>
      <th>손절횟수_202012</th>
      <th>손절횟수_202101</th>
      <th>손절횟수_202102</th>
      <th>손절횟수_202103</th>
      <th>손절횟수_202104</th>
      <th>손절횟수_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>


### 2.8.2. 이익실현 비중 계산

(이익실현횟수) / (이익실현횟수 + 손절횟수)



```python
profit_loss = pd.DataFrame(index = range(0, len(df)), columns = [])
for i in range(0,12):
    profit_loss[i] = profit.iloc[:, i]/(profit.iloc[:, i] + loss.iloc[:, i])

profit_loss.fillna(0, inplace=True)

profit_loss.head(10)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.500000</td>
      <td>0.777778</td>
      <td>0.696970</td>
      <td>0.590909</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.652174</td>
      <td>0.0</td>
      <td>0.644628</td>
      <td>0.631148</td>
      <td>0.636364</td>
      <td>0.576271</td>
      <td>0.590164</td>
      <td>0.580357</td>
      <td>0.617647</td>
      <td>0.640449</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.923077</td>
      <td>0.909091</td>
      <td>0.916667</td>
      <td>0.916667</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.697674</td>
      <td>0.805556</td>
      <td>0.818182</td>
      <td>0.841667</td>
      <td>0.837838</td>
    </tr>
  </tbody>
</table>
</div>


### 2.8.3. 이익실현 비중



```python
colname = '이익실현비중'
profit_loss.columns = [f'{colname}_202006', f'{colname}_202007', f'{colname}_202008', f'{colname}_202009',
                       f'{colname}_202010', f'{colname}_202011', f'{colname}_202012', f'{colname}_202101',
                       f'{colname}_202102', f'{colname}_202103', f'{colname}_202104', f'{colname}_202105']
```


```python
"""
profit_loss.to_csv('profit_loss.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\nprofit_loss.to_csv('profit_loss.csv', sep=',', encoding='utf-8')\n"
</pre>
## 2.9. 신용/대출 성향

: 신용거래 금액



```python
credit1 = df[[f'신용_20200{i}' for i in range(6,10)]]
credit2 = df[[f'신용_2020{i}' for i in range(10,13)]]
credit3 = df[[f'신용_20210{i}' for i in range(1,6)]]

credit = pd.concat([credit1, credit2, credit3], axis=1)
for i in credit:
    credit.loc[:,i] = pd.to_numeric(credit.loc[:,i])

credit.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>신용_202006</th>
      <th>신용_202007</th>
      <th>신용_202008</th>
      <th>신용_202009</th>
      <th>신용_202010</th>
      <th>신용_202011</th>
      <th>신용_202012</th>
      <th>신용_202101</th>
      <th>신용_202102</th>
      <th>신용_202103</th>
      <th>신용_202104</th>
      <th>신용_202105</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1390825</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>250034</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>695531</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>64750</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1288685</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



```python
"""
credit.to_csv('credit.csv', sep=',', encoding='utf-8')
"""
```

<pre>
"\ncredit.to_csv('credit.csv', sep=',', encoding='utf-8')\n"
</pre>
# 3. 사용자별 관심종목 분석


## 3.1. 주식 '보유/매수/매도'별 '1위~3위' 데이터 추출



```python
f_hold_name1 = df[[f'주식보유1위종목_20200{i}' for i in range(6,10)]]
f_hold_name2 = df[[f'주식보유1위종목_2020{i}' for i in range(10,13)]]
f_hold_name3 = df[[f'주식보유1위종목_20210{i}' for i in range(1,6)]]
f_hold_name = pd.concat([f_hold_name1, f_hold_name2, f_hold_name3], axis=1)

s_hold_name1 = df[[f'주식보유2위종목_20200{i}' for i in range(6,10)]]
s_hold_name2 = df[[f'주식보유2위종목_2020{i}' for i in range(10,13)]]
s_hold_name3 = df[[f'주식보유2위종목_20210{i}' for i in range(1,6)]]
s_hold_name = pd.concat([s_hold_name1, s_hold_name2, s_hold_name3], axis=1)

t_hold_name1 = df[[f'주식보유3위종목_20200{i}' for i in range(6,10)]]
t_hold_name2 = df[[f'주식보유3위종목_2020{i}' for i in range(10,13)]]
t_hold_name3 = df[[f'주식보유3위종목_20210{i}' for i in range(1,6)]]
t_hold_name = pd.concat([t_hold_name1, t_hold_name2, t_hold_name3], axis=1)
print(f_hold_name.shape, s_hold_name.shape, t_hold_name.shape)
```

<pre>
(300000, 12) (300000, 12) (300000, 12)
</pre>

```python
f_buy_name1 = df[[f'주식매수1위종목_20200{i}' for i in range(6,10)]]
f_buy_name2 = df[[f'주식매수1위종목_2020{i}' for i in range(10,13)]]
f_buy_name3 = df[[f'주식매수1위종목_20210{i}' for i in range(1,6)]]
f_buy_name = pd.concat([f_buy_name1, f_buy_name2, f_buy_name3], axis=1)

s_buy_name1 = df[[f'주식매수2위종목_20200{i}' for i in range(6,10)]]
s_buy_name2 = df[[f'주식매수2위종목_2020{i}' for i in range(10,13)]]
s_buy_name3 = df[[f'주식매수2위종목_20210{i}' for i in range(1,6)]]
s_buy_name = pd.concat([s_buy_name1, s_buy_name2, s_buy_name3], axis=1)

t_buy_name1 = df[[f'주식매수3위종목_20200{i}' for i in range(6,10)]]
t_buy_name2 = df[[f'주식매수3위종목_2020{i}' for i in range(10,13)]]
t_buy_name3 = df[[f'주식매수3위종목_20210{i}' for i in range(1,6)]]
t_buy_name = pd.concat([t_buy_name1, t_buy_name2, t_buy_name3], axis=1)
print(t_buy_name.shape, t_buy_name.shape, t_buy_name.shape)
```

<pre>
(300000, 12) (300000, 12) (300000, 12)
</pre>

```python
f_sell_name1 = df[[f'주식매도1위종목_20200{i}' for i in range(6,10)]]
f_sell_name2 = df[[f'주식매도1위종목_2020{i}' for i in range(10,13)]]
f_sell_name3 = df[[f'주식매도1위종목_20210{i}' for i in range(1,6)]]
f_sell_name = pd.concat([f_sell_name1, f_sell_name2, f_sell_name3], axis=1)

s_sell_name1 = df[[f'주식매도2위종목_20200{i}' for i in range(6,10)]]
s_sell_name2 = df[[f'주식매도2위종목_2020{i}' for i in range(10,13)]]
s_sell_name3 = df[[f'주식매도2위종목_20210{i}' for i in range(1,6)]]
s_sell_name = pd.concat([s_sell_name1, s_sell_name2, s_sell_name3], axis=1)

t_sell_name1 = df[[f'주식매도3위종목_20200{i}' for i in range(6,10)]]
t_sell_name2 = df[[f'주식매도3위종목_2020{i}' for i in range(10,13)]]
t_sell_name3 = df[[f'주식매도3위종목_20210{i}' for i in range(1,6)]]
t_sell_name = pd.concat([t_sell_name1, t_sell_name2, t_sell_name3], axis=1)
print(t_sell_name.shape, t_sell_name.shape, t_sell_name.shape)
```

<pre>
(300000, 12) (300000, 12) (300000, 12)
</pre>
## 3.2. 관심종목 정보


### 3.2.1. 외부데이터 불러오기



```python
KOSPI = pd.read_csv('KOSPI.csv', engine='python', encoding = 'CP949')
KOSDAQ = pd.read_csv('KOSDAQ.csv', engine='python', encoding = 'CP949')
elw = pd.read_csv('elw.csv', engine='python', encoding = 'CP949')
etf = pd.read_csv('etf.csv', engine='python', encoding = 'CP949')
etn = pd.read_csv('etn.csv', engine='python', encoding = 'CP949')
USA = pd.read_csv('USA.csv')
add = pd.read_csv('업종추가_최종.csv', engine='python', encoding = 'CP949')
```

### 3.2.2. 시장+주식종류+소속부 사전



```python
dic_KOSPI1 = KOSPI[['단축코드']]
dic_KOSDAQ1 = KOSDAQ[['단축코드']]
dic_elw1 = elw[['단축코드']]
dic_etf1 = etf[['단축코드']]
dic_etn1 = etn[['단축코드']]
dic_USA1 = USA[['기호']]
```


```python
#코스피
dic_KOSPI1['주식종류'] = KOSPI[['시장구분','주식종류']].apply(lambda x: '_'.join(x), axis=1)

for i in range(len(dic_KOSPI1)) :
    dic_KOSPI1['단축코드'][i] = 'A'+str(dic_KOSPI1['단축코드'][i])

dic_KOSPI1 = dic_KOSPI1.set_index('단축코드').T.to_dict('list')
```

<pre>
<ipython-input-67-8f99365ec680>:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_KOSPI1['주식종류'] = KOSPI[['시장구분','주식종류']].apply(lambda x: '_'.join(x), axis=1)
C:\Users\choij\anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3437: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  exec(code_obj, self.user_global_ns, self.user_ns)
</pre>

```python
#코스닥
dic_KOSDAQ1['주식종류'] = KOSDAQ[['시장구분','주식종류','소속부']].apply(lambda x: '_'.join(x), axis=1)

for i in range(len(dic_KOSDAQ1)) :
    dic_KOSDAQ1['단축코드'][i] = 'A'+str(dic_KOSDAQ1['단축코드'][i])

dic_KOSDAQ1 = dic_KOSDAQ1.set_index('단축코드').T.to_dict('list')
```

<pre>
<ipython-input-68-24acd2a2b36d>:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_KOSDAQ1['주식종류'] = KOSDAQ[['시장구분','주식종류','소속부']].apply(lambda x: '_'.join(x), axis=1)
</pre>

```python
#ELW
for i in range(len(dic_elw1)) :
    dic_elw1['단축코드'][i] = 'A'+str(dic_elw1['단축코드'][i])

dic_elw1['시장구분'] = 'ELW'
dic_elw1 = dic_elw1.set_index('단축코드').T.to_dict('list')
```

<pre>
<ipython-input-69-a8113f47b1ed>:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_elw1['시장구분'] = 'ELW'
</pre>

```python
#ETF
for i in range(len(dic_etf1)) :
    dic_etf1['단축코드'][i] = 'A'+str(dic_etf1['단축코드'][i])

dic_etf1['시장구분'] = 'ETF'
dic_etf1 = dic_etf1.set_index('단축코드').T.to_dict('list')
```

<pre>
C:\Users\choij\anaconda3\lib\site-packages\pandas\core\indexing.py:692: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  iloc._setitem_with_indexer(indexer, value, self.name)
<ipython-input-70-fd5339e37265>:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_etf1['시장구분'] = 'ETF'
</pre>

```python
#ETN
for i in range(len(dic_etn1)) :
    dic_etn1['단축코드'][i] = 'A'+str(dic_etn1['단축코드'][i])
    
dic_etn1['시장구분'] = 'ETN'
dic_etn1 = dic_etn1.set_index('단축코드').T.to_dict('list')
```

<pre>
<ipython-input-71-99cafaa964c9>:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_etn1['시장구분'] = 'ETN'
</pre>

```python
#USA
dic_USA1['시장구분'] = 'USA'
dic_USA1 = dic_USA1.set_index('기호').T.to_dict('list')
```

<pre>
<ipython-input-72-ffdccebe8899>:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_USA1['시장구분'] = 'USA'
</pre>

```python
#추가 코스피
add_kospi = add['시장구분'] == 'KOSPI'
add_kospi = add[add_kospi]

dic_add_kospi = add_kospi[['종목코드']]
dic_add_kospi['주식종류'] = add_kospi[['시장구분','주식종류']].apply(lambda x: '_'.join(x), axis=1)
dic_add_kospi = dic_add_kospi.set_index('종목코드').T.to_dict('list')
dic_add_kospi
```

<pre>
<ipython-input-73-b3408685da3c>:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_add_kospi['주식종류'] = add_kospi[['시장구분','주식종류']].apply(lambda x: '_'.join(x), axis=1)
</pre>
<pre>
{'A003415': ['KOSPI_우선주'],
 'A152330': ['KOSPI_보통주'],
 'A004200': ['KOSPI_보통주'],
 'A033660': ['KOSPI_보통주'],
 'A002300': ['KOSPI_보통주'],
 'A005190': ['KOSPI_보통주']}
</pre>

```python
#추가 코스닥
add_kosdaq = add['시장구분'] == 'KOSDAQ'
add_kosdaq = add[add_kosdaq]

dic_add_kosdaq = add_kosdaq[['종목코드']]
dic_add_kosdaq['주식종류'] = add_kosdaq[['시장구분','주식종류','소속부']].apply(lambda x: '_'.join(x), axis=1)
dic_add_kosdaq = dic_add_kosdaq.set_index('종목코드').T.to_dict('list')
dic_add_kosdaq
```

<pre>
<ipython-input-74-ff3811b1b994>:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_add_kosdaq['주식종류'] = add_kosdaq[['시장구분','주식종류','소속부']].apply(lambda x: '_'.join(x), axis=1)
<ipython-input-74-ff3811b1b994>:7: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  dic_add_kosdaq = dic_add_kosdaq.set_index('종목코드').T.to_dict('list')
</pre>
<pre>
{'A065940': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A204990': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A141070': ['KOSDAQ_보통주_벤처기업부'],
 'A073070': ['KOSDAQ_보통주_투자주의환기종목'],
 'A057500': ['KOSDAQ_보통주_우량기업부'],
 'A102210': ['KOSDAQ_보통주_관리종목'],
 'A036260': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A108790': ['KOSDAQ_보통주_중견기업부'],
 'A028150': ['KOSDAQ_보통주_우량기업부'],
 'A033430': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A134780': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A038160': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A226350': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A900080': ['KOSDAQ_보통주_외국기업'],
 'A086250': ['KOSDAQ_보통주_관리종목'],
 'A194510': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A065620': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A023890': ['KOSDAQ_보통주_우량기업부'],
 'A080440': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A195440': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A033600': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A008800': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A028040': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A149940': ['KOSDAQ_보통주_관리 및 투자주의환기종목'],
 'A043290': ['KOSDAQ_보통주_벤처기업부'],
 'A307070': ['KOSDAQ_보통주_SPAC'],
 'A307160': ['KOSDAQ_보통주_SPAC'],
 'A311270': ['KOSDAQ_보통주_SPAC']}
</pre>

```python
print(len(dic_KOSPI1)+ len(dic_KOSDAQ1)+ len(dic_elw1)+ len(dic_etf1)+len(dic_etn1)+len(dic_USA1)+len(dic_add_kospi)+len(dic_add_kosdaq))
```

<pre>
6929
</pre>

```python
len({**dic_KOSPI1, **dic_KOSDAQ1, **dic_elw1, **dic_etf1, **dic_etn1, **dic_USA1, **dic_add_kospi, **dic_add_kosdaq})
```

<pre>
6929
</pre>

```python
type_dic = {**dic_KOSPI1, **dic_KOSDAQ1, **dic_elw1, **dic_etf1, **dic_etn1, **dic_USA1, **dic_add_kospi, **dic_add_kosdaq}
type_dic
```

<pre>
{'A095570': ['KOSPI_보통주'],
 'A006840': ['KOSPI_보통주'],
 'A282330': ['KOSPI_보통주'],
 'A027410': ['KOSPI_보통주'],
 'A138930': ['KOSPI_보통주'],
 'A001465': ['KOSPI_구형우선주'],
 'A001460': ['KOSPI_보통주'],
 'A001045': ['KOSPI_구형우선주'],
 'A00104K': ['KOSPI_신형우선주'],
 'A001040': ['KOSPI_보통주'],
 'A011155': ['KOSPI_구형우선주'],
 'A011150': ['KOSPI_보통주'],
 'A000590': ['KOSPI_보통주'],
 'A012030': ['KOSPI_보통주'],
 'A016610': ['KOSPI_보통주'],
 'A005830': ['KOSPI_보통주'],
 'A000995': ['KOSPI_구형우선주'],
 'A000990': ['KOSPI_보통주'],
 'A139130': ['KOSPI_보통주'],
 'A001530': ['KOSPI_보통주'],
 'A000215': ['KOSPI_구형우선주'],
 'A001880': ['KOSPI_보통주'],
 'A000210': ['KOSPI_보통주'],
 'A37550K': ['KOSPI_종류주권'],
 'A375500': ['KOSPI_보통주'],
 'A155660': ['KOSPI_보통주'],
 'A069730': ['KOSPI_보통주'],
 'A017940': ['KOSPI_보통주'],
 'A365550': ['KOSPI_보통주'],
 'A383220': ['KOSPI_보통주'],
 'A007700': ['KOSPI_보통주'],
 'A078935': ['KOSPI_구형우선주'],
 'A006360': ['KOSPI_보통주'],
 'A078930': ['KOSPI_보통주'],
 'A012630': ['KOSPI_보통주'],
 'A294870': ['KOSPI_보통주'],
 'A003560': ['KOSPI_보통주'],
 'A175330': ['KOSPI_보통주'],
 'A234080': ['KOSPI_보통주'],
 'A001065': ['KOSPI_구형우선주'],
 'A001067': ['KOSPI_신형우선주'],
 'A001060': ['KOSPI_보통주'],
 'A096760': ['KOSPI_보통주'],
 'A105560': ['KOSPI_보통주'],
 'A009070': ['KOSPI_보통주'],
 'A016385': ['KOSPI_구형우선주'],
 'A016380': ['KOSPI_보통주'],
 'A001390': ['KOSPI_보통주'],
 'A033180': ['KOSPI_보통주'],
 'A001940': ['KOSPI_보통주'],
 'A025000': ['KOSPI_보통주'],
 'A092230': ['KOSPI_보통주'],
 'A000040': ['KOSPI_보통주'],
 'A093050': ['KOSPI_보통주'],
 'A003555': ['KOSPI_구형우선주'],
 'A034220': ['KOSPI_보통주'],
 'A003550': ['KOSPI_보통주'],
 'A051905': ['KOSPI_구형우선주'],
 'A051900': ['KOSPI_보통주'],
 'A032640': ['KOSPI_보통주'],
 'A011070': ['KOSPI_보통주'],
 'A066575': ['KOSPI_구형우선주'],
 'A066570': ['KOSPI_보통주'],
 'A051915': ['KOSPI_구형우선주'],
 'A051910': ['KOSPI_보통주'],
 'A079550': ['KOSPI_보통주'],
 'A010120': ['KOSPI_보통주'],
 'A000680': ['KOSPI_보통주'],
 'A006260': ['KOSPI_보통주'],
 'A001120': ['KOSPI_보통주'],
 'A023150': ['KOSPI_보통주'],
 'A035420': ['KOSPI_보통주'],
 'A181710': ['KOSPI_보통주'],
 'A338100': ['KOSPI_보통주'],
 'A034310': ['KOSPI_보통주'],
 'A008260': ['KOSPI_보통주'],
 'A004255': ['KOSPI_구형우선주'],
 'A004250': ['KOSPI_보통주'],
 'A010060': ['KOSPI_보통주'],
 'A010955': ['KOSPI_구형우선주'],
 'A010950': ['KOSPI_보통주'],
 'A101060': ['KOSPI_보통주'],
 'A005090': ['KOSPI_보통주'],
 'A001380': ['KOSPI_보통주'],
 'A001770': ['KOSPI_보통주'],
 'A002360': ['KOSPI_보통주'],
 'A009160': ['KOSPI_보통주'],
 'A123700': ['KOSPI_보통주'],
 'A025530': ['KOSPI_보통주'],
 'A03473K': ['KOSPI_종류주권'],
 'A011790': ['KOSPI_보통주'],
 'A018670': ['KOSPI_보통주'],
 'A001745': ['KOSPI_구형우선주'],
 'A001740': ['KOSPI_보통주'],
 'A210980': ['KOSPI_보통주'],
 'A395400': ['KOSPI_보통주'],
 'A034730': ['KOSPI_보통주'],
 'A361610': ['KOSPI_보통주'],
 'A096775': ['KOSPI_구형우선주'],
 'A096770': ['KOSPI_보통주'],
 'A001515': ['KOSPI_구형우선주'],
 'A001510': ['KOSPI_보통주'],
 'A28513K': ['KOSPI_종류주권'],
 'A285130': ['KOSPI_보통주'],
 'A017670': ['KOSPI_보통주'],
 'A064960': ['KOSPI_보통주'],
 'A100840': ['KOSPI_보통주'],
 'A003570': ['KOSPI_보통주'],
 'A036530': ['KOSPI_보통주'],
 'A005610': ['KOSPI_보통주'],
 'A011810': ['KOSPI_보통주'],
 'A077970': ['KOSPI_보통주'],
 'A071970': ['KOSPI_보통주'],
 'A084870': ['KOSPI_보통주'],
 'A002710': ['KOSPI_보통주'],
 'A024070': ['KOSPI_보통주'],
 'A000500': ['KOSPI_보통주'],
 'A000860': ['KOSPI_보통주'],
 'A035250': ['KOSPI_보통주'],
 'A011420': ['KOSPI_보통주'],
 'A002100': ['KOSPI_보통주'],
 'A009450': ['KOSPI_보통주'],
 'A267290': ['KOSPI_보통주'],
 'A012320': ['KOSPI_보통주'],
 'A000050': ['KOSPI_보통주'],
 'A214390': ['KOSPI_보통주'],
 'A012610': ['KOSPI_보통주'],
 'A009140': ['KOSPI_보통주'],
 'A013580': ['KOSPI_보통주'],
 'A012205': ['KOSPI_구형우선주'],
 'A012200': ['KOSPI_보통주'],
 'A002140': ['KOSPI_보통주'],
 'A010130': ['KOSPI_보통주'],
 'A002240': ['KOSPI_보통주'],
 'A009290': ['KOSPI_보통주'],
 'A017040': ['KOSPI_보통주'],
 'A017900': ['KOSPI_보통주'],
 'A037710': ['KOSPI_보통주'],
 'A030610': ['KOSPI_보통주'],
 'A339770': ['KOSPI_보통주'],
 'A007690': ['KOSPI_보통주'],
 'A005320': ['KOSPI_보통주'],
 'A001140': ['KOSPI_보통주'],
 'A002720': ['KOSPI_보통주'],
 'A114090': ['KOSPI_보통주'],
 'A083420': ['KOSPI_보통주'],
 'A014530': ['KOSPI_보통주'],
 'A014285': ['KOSPI_구형우선주'],
 'A014280': ['KOSPI_보통주'],
 'A008870': ['KOSPI_보통주'],
 'A001570': ['KOSPI_보통주'],
 'A002995': ['KOSPI_구형우선주'],
 'A002990': ['KOSPI_보통주'],
 'A011785': ['KOSPI_구형우선주'],
 'A011780': ['KOSPI_보통주'],
 'A214330': ['KOSPI_보통주'],
 'A001210': ['KOSPI_보통주'],
 'A073240': ['KOSPI_보통주'],
 'A092440': ['KOSPI_보통주'],
 'A000270': ['KOSPI_보통주'],
 'A013700': ['KOSPI_보통주'],
 'A004545': ['KOSPI_구형우선주'],
 'A004540': ['KOSPI_보통주'],
 'A001260': ['KOSPI_보통주'],
 'A008355': ['KOSPI_구형우선주'],
 'A008350': ['KOSPI_보통주'],
 'A004270': ['KOSPI_보통주'],
 'A003925': ['KOSPI_구형우선주'],
 'A003920': ['KOSPI_보통주'],
 'A025860': ['KOSPI_보통주'],
 'A005725': ['KOSPI_구형우선주'],
 'A005720': ['KOSPI_보통주'],
 'A002355': ['KOSPI_신형우선주'],
 'A002350': ['KOSPI_보통주'],
 'A003580': ['KOSPI_보통주'],
 'A251270': ['KOSPI_보통주'],
 'A090355': ['KOSPI_구형우선주'],
 'A090350': ['KOSPI_보통주'],
 'A000325': ['KOSPI_구형우선주'],
 'A000320': ['KOSPI_보통주'],
 'A006280': ['KOSPI_보통주'],
 'A005257': ['KOSPI_신형우선주'],
 'A005250': ['KOSPI_보통주'],
 'A004370': ['KOSPI_보통주'],
 'A072710': ['KOSPI_보통주'],
 'A058730': ['KOSPI_보통주'],
 'A023590': ['KOSPI_보통주'],
 'A145210': ['KOSPI_보통주'],
 'A019680': ['KOSPI_보통주'],
 'A019685': ['KOSPI_신형우선주'],
 'A006370': ['KOSPI_보통주'],
 'A00806K': ['KOSPI_종류주권'],
 'A008060': ['KOSPI_보통주'],
 'A353200': ['KOSPI_보통주'],
 'A35320K': ['KOSPI_종류주권'],
 'A000490': ['KOSPI_보통주'],
 'A008110': ['KOSPI_보통주'],
 'A005750': ['KOSPI_보통주'],
 'A006570': ['KOSPI_보통주'],
 'A001685': ['KOSPI_구형우선주'],
 'A001680': ['KOSPI_보통주'],
 'A084695': ['KOSPI_구형우선주'],
 'A084690': ['KOSPI_보통주'],
 'A128820': ['KOSPI_보통주'],
 'A117580': ['KOSPI_보통주'],
 'A016710': ['KOSPI_보통주'],
 'A003545': ['KOSPI_구형우선주'],
 'A003547': ['KOSPI_신형우선주'],
 'A003540': ['KOSPI_보통주'],
 'A009190': ['KOSPI_보통주'],
 'A014160': ['KOSPI_보통주'],
 'A047040': ['KOSPI_보통주'],
 'A009320': ['KOSPI_보통주'],
 'A042660': ['KOSPI_보통주'],
 'A003090': ['KOSPI_보통주'],
 'A069620': ['KOSPI_보통주'],
 'A000430': ['KOSPI_보통주'],
 'A006345': ['KOSPI_구형우선주'],
 'A006340': ['KOSPI_보통주'],
 'A003220': ['KOSPI_보통주'],
 'A024890': ['KOSPI_보통주'],
 'A002880': ['KOSPI_보통주'],
 'A000300': ['KOSPI_보통주'],
 'A015230': ['KOSPI_보통주'],
 'A012800': ['KOSPI_보통주'],
 'A001070': ['KOSPI_보통주'],
 'A006650': ['KOSPI_보통주'],
 'A001440': ['KOSPI_보통주'],
 'A084010': ['KOSPI_보통주'],
 'A001795': ['KOSPI_구형우선주'],
 'A001790': ['KOSPI_보통주'],
 'A001130': ['KOSPI_보통주'],
 'A003495': ['KOSPI_구형우선주'],
 'A003490': ['KOSPI_보통주'],
 'A005880': ['KOSPI_보통주'],
 'A003830': ['KOSPI_보통주'],
 'A016090': ['KOSPI_보통주'],
 'A069460': ['KOSPI_보통주'],
 'A192080': ['KOSPI_보통주'],
 'A012510': ['KOSPI_보통주'],
 'A004835': ['KOSPI_구형우선주'],
 'A004830': ['KOSPI_보통주'],
 'A024900': ['KOSPI_보통주'],
 'A145720': ['KOSPI_보통주'],
 'A002150': ['KOSPI_보통주'],
 'A001230': ['KOSPI_보통주'],
 'A004140': ['KOSPI_보통주'],
 'A007590': ['KOSPI_보통주'],
 'A005965': ['KOSPI_구형우선주'],
 'A005960': ['KOSPI_보통주'],
 'A026960': ['KOSPI_보통주'],
 'A002210': ['KOSPI_보통주'],
 'A102260': ['KOSPI_보통주'],
 'A000640': ['KOSPI_보통주'],
 'A170900': ['KOSPI_보통주'],
 'A028100': ['KOSPI_보통주'],
 'A282690': ['KOSPI_보통주'],
 'A001525': ['KOSPI_구형우선주'],
 'A001527': ['KOSPI_신형우선주'],
 'A001529': ['KOSPI_신형우선주'],
 'A084670': ['KOSPI_보통주'],
 'A001520': ['KOSPI_보통주'],
 'A082640': ['KOSPI_보통주'],
 'A008970': ['KOSPI_보통주'],
 'A092780': ['KOSPI_보통주'],
 'A049770': ['KOSPI_보통주'],
 'A018500': ['KOSPI_보통주'],
 'A006040': ['KOSPI_보통주'],
 'A030720': ['KOSPI_보통주'],
 'A014825': ['KOSPI_구형우선주'],
 'A014820': ['KOSPI_보통주'],
 'A163560': ['KOSPI_보통주'],
 'A004890': ['KOSPI_보통주'],
 'A002690': ['KOSPI_보통주'],
 'A000020': ['KOSPI_보통주'],
 'A000155': ['KOSPI_구형우선주'],
 'A000157': ['KOSPI_신형우선주'],
 'A241560': ['KOSPI_보통주'],
 'A000150': ['KOSPI_보통주'],
 'A042670': ['KOSPI_보통주'],
 'A034020': ['KOSPI_보통주'],
 'A33626K': ['KOSPI_구형우선주'],
 'A33626L': ['KOSPI_신형우선주'],
 'A336260': ['KOSPI_보통주'],
 'A016740': ['KOSPI_보통주'],
 'A192650': ['KOSPI_보통주'],
 'A024090': ['KOSPI_보통주'],
 'A003160': ['KOSPI_보통주'],
 'A092200': ['KOSPI_보통주'],
 'A004840': ['KOSPI_보통주'],
 'A377190': ['KOSPI_보통주'],
 'A013570': ['KOSPI_보통주'],
 'A210540': ['KOSPI_보통주'],
 'A007340': ['KOSPI_보통주'],
 'A026890': ['KOSPI_보통주'],
 'A115390': ['KOSPI_보통주'],
 'A032350': ['KOSPI_보통주'],
 'A089860': ['KOSPI_보통주'],
 'A330590': ['KOSPI_보통주'],
 'A000400': ['KOSPI_보통주'],
 'A023530': ['KOSPI_보통주'],
 'A004000': ['KOSPI_보통주'],
 'A286940': ['KOSPI_보통주'],
 'A280360': ['KOSPI_보통주'],
 'A00499K': ['KOSPI_구형우선주'],
 'A004990': ['KOSPI_보통주'],
 'A005305': ['KOSPI_구형우선주'],
 'A005300': ['KOSPI_보통주'],
 'A011170': ['KOSPI_보통주'],
 'A002270': ['KOSPI_보통주'],
 'A071840': ['KOSPI_보통주'],
 'A027740': ['KOSPI_보통주'],
 'A204320': ['KOSPI_보통주'],
 'A001080': ['KOSPI_보통주'],
 'A088980': ['KOSPI_보통주'],
 'A138040': ['KOSPI_보통주'],
 'A008560': ['KOSPI_보통주'],
 'A000060': ['KOSPI_보통주'],
 'A090370': ['KOSPI_보통주'],
 'A017180': ['KOSPI_보통주'],
 'A009900': ['KOSPI_보통주'],
 'A012690': ['KOSPI_보통주'],
 'A005360': ['KOSPI_보통주'],
 'A204210': ['KOSPI_보통주'],
 'A009680': ['KOSPI_보통주'],
 'A009200': ['KOSPI_보통주'],
 'A009580': ['KOSPI_보통주'],
 'A033920': ['KOSPI_보통주'],
 'A008420': ['KOSPI_보통주'],
 'A025560': ['KOSPI_보통주'],
 'A007120': ['KOSPI_보통주'],
 'A357250': ['KOSPI_보통주'],
 'A094800': ['KOSPI_보통주'],
 'A085620': ['KOSPI_보통주'],
 'A006805': ['KOSPI_구형우선주'],
 'A00680K': ['KOSPI_신형우선주'],
 'A006800': ['KOSPI_보통주'],
 'A002840': ['KOSPI_보통주'],
 'A268280': ['KOSPI_보통주'],
 'A107590': ['KOSPI_보통주'],
 'A134380': ['KOSPI_보통주'],
 'A003650': ['KOSPI_보통주'],
 'A155900': ['KOSPI_보통주'],
 'A003610': ['KOSPI_보통주'],
 'A001340': ['KOSPI_보통주'],
 'A035150': ['KOSPI_보통주'],
 'A002410': ['KOSPI_보통주'],
 'A007210': ['KOSPI_보통주'],
 'A002760': ['KOSPI_보통주'],
 'A003850': ['KOSPI_보통주'],
 'A000890': ['KOSPI_보통주'],
 'A003000': ['KOSPI_보통주'],
 'A001275': ['KOSPI_구형우선주'],
 'A001270': ['KOSPI_보통주'],
 'A026940': ['KOSPI_보통주'],
 'A015350': ['KOSPI_보통주'],
 'A011390': ['KOSPI_보통주'],
 'A005030': ['KOSPI_보통주'],
 'A002070': ['KOSPI_보통주'],
 'A100220': ['KOSPI_보통주'],
 'A030790': ['KOSPI_보통주'],
 'A005180': ['KOSPI_보통주'],
 'A003960': ['KOSPI_보통주'],
 'A008040': ['KOSPI_보통주'],
 'A007160': ['KOSPI_보통주'],
 'A014710': ['KOSPI_보통주'],
 'A006090': ['KOSPI_보통주'],
 'A001470': ['KOSPI_보통주'],
 'A006405': ['KOSPI_구형우선주'],
 'A006400': ['KOSPI_보통주'],
 'A006660': ['KOSPI_보통주'],
 'A02826K': ['KOSPI_종류주권'],
 'A028260': ['KOSPI_보통주'],
 'A207940': ['KOSPI_보통주'],
 'A032830': ['KOSPI_보통주'],
 'A018260': ['KOSPI_보통주'],
 'A028050': ['KOSPI_보통주'],
 'A009155': ['KOSPI_구형우선주'],
 'A009150': ['KOSPI_보통주'],
 'A005935': ['KOSPI_구형우선주'],
 'A005930': ['KOSPI_보통주'],
 'A001360': ['KOSPI_보통주'],
 'A010145': ['KOSPI_구형우선주'],
 'A010140': ['KOSPI_보통주'],
 'A016360': ['KOSPI_보통주'],
 'A068290': ['KOSPI_보통주'],
 'A029780': ['KOSPI_보통주'],
 'A000815': ['KOSPI_구형우선주'],
 'A000810': ['KOSPI_보통주'],
 'A006110': ['KOSPI_보통주'],
 'A145995': ['KOSPI_구형우선주'],
 'A145990': ['KOSPI_보통주'],
 'A003230': ['KOSPI_보통주'],
 'A002170': ['KOSPI_보통주'],
 'A272550': ['KOSPI_보통주'],
 'A000075': ['KOSPI_구형우선주'],
 'A000070': ['KOSPI_보통주'],
 'A002810': ['KOSPI_보통주'],
 'A005680': ['KOSPI_보통주'],
 'A003720': ['KOSPI_보통주'],
 'A023000': ['KOSPI_보통주'],
 'A004380': ['KOSPI_보통주'],
 'A002450': ['KOSPI_보통주'],
 'A004440': ['KOSPI_보통주'],
 'A000520': ['KOSPI_보통주'],
 'A009770': ['KOSPI_보통주'],
 'A005500': ['KOSPI_보통주'],
 'A004690': ['KOSPI_보통주'],
 'A010960': ['KOSPI_보통주'],
 'A004450': ['KOSPI_보통주'],
 'A009470': ['KOSPI_보통주'],
 'A011230': ['KOSPI_보통주'],
 'A001820': ['KOSPI_보통주'],
 'A000390': ['KOSPI_보통주'],
 'A001290': ['KOSPI_보통주'],
 'A041650': ['KOSPI_보통주'],
 'A075180': ['KOSPI_보통주'],
 'A007540': ['KOSPI_보통주'],
 'A248170': ['KOSPI_보통주'],
 'A007860': ['KOSPI_보통주'],
 'A200880': ['KOSPI_보통주'],
 'A017390': ['KOSPI_보통주'],
 'A004415': ['KOSPI_구형우선주'],
 'A004410': ['KOSPI_보통주'],
 'A021050': ['KOSPI_보통주'],
 'A008490': ['KOSPI_보통주'],
 'A007610': ['KOSPI_보통주'],
 'A002820': ['KOSPI_보통주'],
 'A136490': ['KOSPI_보통주'],
 'A014915': ['KOSPI_구형우선주'],
 'A014910': ['KOSPI_보통주'],
 'A003080': ['KOSPI_보통주'],
 'A004985': ['KOSPI_구형우선주'],
 'A004980': ['KOSPI_보통주'],
 'A011300': ['KOSPI_보통주'],
 'A000180': ['KOSPI_보통주'],
 'A002420': ['KOSPI_보통주'],
 'A004365': ['KOSPI_구형우선주'],
 'A004360': ['KOSPI_보통주'],
 'A004490': ['KOSPI_보통주'],
 'A001430': ['KOSPI_보통주'],
 'A306200': ['KOSPI_보통주'],
 'A003030': ['KOSPI_보통주'],
 'A019440': ['KOSPI_보통주'],
 'A058650': ['KOSPI_보통주'],
 'A013000': ['KOSPI_보통주'],
 'A091090': ['KOSPI_보통주'],
 'A021820': ['KOSPI_보통주'],
 'A067830': ['KOSPI_보통주'],
 'A033530': ['KOSPI_보통주'],
 'A075580': ['KOSPI_보통주'],
 'A027970': ['KOSPI_보통주'],
 'A308170': ['KOSPI_보통주'],
 'A012600': ['KOSPI_보통주'],
 'A068270': ['KOSPI_보통주'],
 'A33637K': ['KOSPI_구형우선주'],
 'A33637L': ['KOSPI_신형우선주'],
 'A336370': ['KOSPI_보통주'],
 'A248070': ['KOSPI_보통주'],
 'A004430': ['KOSPI_보통주'],
 'A017550': ['KOSPI_보통주'],
 'A134790': ['KOSPI_보통주'],
 'A016590': ['KOSPI_보통주'],
 'A029530': ['KOSPI_보통주'],
 'A004970': ['KOSPI_보통주'],
 'A011930': ['KOSPI_보통주'],
 'A005390': ['KOSPI_보통주'],
 'A034300': ['KOSPI_보통주'],
 'A004170': ['KOSPI_보통주'],
 'A035510': ['KOSPI_보통주'],
 'A031430': ['KOSPI_보통주'],
 'A031440': ['KOSPI_보통주'],
 'A006880': ['KOSPI_보통주'],
 'A005800': ['KOSPI_보통주'],
 'A001725': ['KOSPI_구형우선주'],
 'A001720': ['KOSPI_보통주'],
 'A009275': ['KOSPI_구형우선주'],
 'A009270': ['KOSPI_보통주'],
 'A002700': ['KOSPI_보통주'],
 'A019175': ['KOSPI_구형우선주'],
 'A019170': ['KOSPI_보통주'],
 'A002870': ['KOSPI_보통주'],
 'A055550': ['KOSPI_보통주'],
 'A293940': ['KOSPI_보통주'],
 'A004080': ['KOSPI_보통주'],
 'A102280': ['KOSPI_보통주'],
 'A003410': ['KOSPI_보통주'],
 'A003620': ['KOSPI_보통주'],
 'A004770': ['KOSPI_보통주'],
 'A015540': ['KOSPI_보통주'],
 'A004920': ['KOSPI_보통주'],
 'A112610': ['KOSPI_보통주'],
 'A000120': ['KOSPI_보통주'],
 'A079160': ['KOSPI_보통주'],
 'A097955': ['KOSPI_구형우선주'],
 'A097950': ['KOSPI_보통주'],
 'A008700': ['KOSPI_보통주'],
 'A002795': ['KOSPI_구형우선주'],
 'A00279K': ['KOSPI_신형우선주'],
 'A002790': ['KOSPI_보통주'],
 'A090435': ['KOSPI_구형우선주'],
 'A090430': ['KOSPI_보통주'],
 'A002030': ['KOSPI_보통주'],
 'A183190': ['KOSPI_보통주'],
 'A002310': ['KOSPI_보통주'],
 'A012170': ['KOSPI_보통주'],
 'A267850': ['KOSPI_보통주'],
 'A020560': ['KOSPI_보통주'],
 'A122900': ['KOSPI_보통주'],
 'A010780': ['KOSPI_보통주'],
 'A139990': ['KOSPI_보통주'],
 'A001780': ['KOSPI_보통주'],
 'A018250': ['KOSPI_보통주'],
 'A161000': ['KOSPI_보통주'],
 'A011090': ['KOSPI_보통주'],
 'A137310': ['KOSPI_보통주'],
 'A034120': ['KOSPI_보통주'],
 'A005850': ['KOSPI_보통주'],
 'A012750': ['KOSPI_보통주'],
 'A004060': ['KOSPI_보통주'],
 'A006125': ['KOSPI_구형우선주'],
 'A006120': ['KOSPI_보통주'],
 'A068400': ['KOSPI_보통주'],
 'A302440': ['KOSPI_보통주'],
 'A326030': ['KOSPI_보통주'],
 'A000660': ['KOSPI_보통주'],
 'A023960': ['KOSPI_보통주'],
 'A298690': ['KOSPI_보통주'],
 'A078520': ['KOSPI_보통주'],
 'A015260': ['KOSPI_보통주'],
 'A140910': ['KOSPI_보통주'],
 'A039570': ['KOSPI_보통주'],
 'A089470': ['KOSPI_보통주'],
 'A082740': ['KOSPI_보통주'],
 'A011200': ['KOSPI_보통주'],
 'A007460': ['KOSPI_보통주'],
 'A003060': ['KOSPI_보통주'],
 'A244920': ['KOSPI_보통주'],
 'A036570': ['KOSPI_보통주'],
 'A138250': ['KOSPI_보통주'],
 'A380440': ['KOSPI_보통주'],
 'A005945': ['KOSPI_구형우선주'],
 'A005940': ['KOSPI_보통주'],
 'A085310': ['KOSPI_보통주'],
 'A009810': ['KOSPI_보통주'],
 'A900140': ['KOSPI_보통주'],
 'A229640': ['KOSPI_보통주'],
 'A108675': ['KOSPI_구형우선주'],
 'A108670': ['KOSPI_보통주'],
 'A38380K': ['KOSPI_종류주권'],
 'A383800': ['KOSPI_보통주'],
 'A037560': ['KOSPI_보통주'],
 'A097520': ['KOSPI_보통주'],
 'A014440': ['KOSPI_보통주'],
 'A111770': ['KOSPI_보통주'],
 'A009970': ['KOSPI_보통주'],
 'A003520': ['KOSPI_보통주'],
 'A000670': ['KOSPI_보통주'],
 'A006740': ['KOSPI_보통주'],
 'A012280': ['KOSPI_보통주'],
 'A012160': ['KOSPI_보통주'],
 'A015360': ['KOSPI_보통주'],
 'A007310': ['KOSPI_보통주'],
 'A002630': ['KOSPI_보통주'],
 'A271560': ['KOSPI_보통주'],
 'A001800': ['KOSPI_보통주'],
 'A037270': ['KOSPI_보통주'],
 'A011690': ['KOSPI_보통주'],
 'A316140': ['KOSPI_보통주'],
 'A118000': ['KOSPI_보통주'],
 'A010050': ['KOSPI_보통주'],
 'A006980': ['KOSPI_보통주'],
 'A017370': ['KOSPI_보통주'],
 'A105840': ['KOSPI_보통주'],
 'A010400': ['KOSPI_보통주'],
 'A049800': ['KOSPI_보통주'],
 'A016880': ['KOSPI_보통주'],
 'A095720': ['KOSPI_보통주'],
 'A005820': ['KOSPI_보통주'],
 'A010600': ['KOSPI_보통주'],
 'A008600': ['KOSPI_보통주'],
 'A014830': ['KOSPI_보통주'],
 'A047400': ['KOSPI_보통주'],
 'A000910': ['KOSPI_보통주'],
 'A011330': ['KOSPI_보통주'],
 'A077500': ['KOSPI_보통주'],
 'A002920': ['KOSPI_보통주'],
 'A000700': ['KOSPI_보통주'],
 'A003475': ['KOSPI_구형우선주'],
 'A003470': ['KOSPI_보통주'],
 'A072130': ['KOSPI_보통주'],
 'A000225': ['KOSPI_구형우선주'],
 'A000227': ['KOSPI_신형우선주'],
 'A000220': ['KOSPI_보통주'],
 'A001200': ['KOSPI_보통주'],
 'A000105': ['KOSPI_구형우선주'],
 'A000100': ['KOSPI_보통주'],
 'A003465': ['KOSPI_구형우선주'],
 'A003460': ['KOSPI_보통주'],
 'A008730': ['KOSPI_보통주'],
 'A008250': ['KOSPI_보통주'],
 'A025820': ['KOSPI_보통주'],
 'A214320': ['KOSPI_보통주'],
 'A088260': ['KOSPI_보통주'],
 'A139480': ['KOSPI_보통주'],
 'A007660': ['KOSPI_보통주'],
 'A005950': ['KOSPI_보통주'],
 'A015020': ['KOSPI_보통주'],
 'A093230': ['KOSPI_보통주'],
 'A074610': ['KOSPI_보통주'],
 'A102460': ['KOSPI_보통주'],
 'A084680': ['KOSPI_보통주'],
 'A350520': ['KOSPI_보통주'],
 'A334890': ['KOSPI_보통주'],
 'A000760': ['KOSPI_보통주'],
 'A014990': ['KOSPI_보통주'],
 'A101140': ['KOSPI_보통주'],
 'A006490': ['KOSPI_보통주'],
 'A023800': ['KOSPI_보통주'],
 'A034590': ['KOSPI_보통주'],
 'A129260': ['KOSPI_보통주'],
 'A023810': ['KOSPI_보통주'],
 'A249420': ['KOSPI_보통주'],
 'A000230': ['KOSPI_보통주'],
 'A013360': ['KOSPI_보통주'],
 'A003120': ['KOSPI_보통주'],
 'A003200': ['KOSPI_보통주'],
 'A007110': ['KOSPI_보통주'],
 'A007575': ['KOSPI_구형우선주'],
 'A007570': ['KOSPI_보통주'],
 'A008500': ['KOSPI_보통주'],
 'A081000': ['KOSPI_보통주'],
 'A020760': ['KOSPI_보통주'],
 'A020150': ['KOSPI_보통주'],
 'A103590': ['KOSPI_보통주'],
 'A271940': ['KOSPI_보통주'],
 'A015860': ['KOSPI_보통주'],
 'A226320': ['KOSPI_보통주'],
 'A317400': ['KOSPI_보통주'],
 'A033240': ['KOSPI_보통주'],
 'A000950': ['KOSPI_보통주'],
 'A348950': ['KOSPI_보통주'],
 'A194370': ['KOSPI_보통주'],
 'A025620': ['KOSPI_보통주'],
 'A036420': ['KOSPI_보통주'],
 'A030000': ['KOSPI_보통주'],
 'A271980': ['KOSPI_보통주'],
 'A001560': ['KOSPI_보통주'],
 'A002620': ['KOSPI_보통주'],
 'A006220': ['KOSPI_보통주'],
 'A089590': ['KOSPI_보통주'],
 'A004910': ['KOSPI_보통주'],
 'A004700': ['KOSPI_보통주'],
 'A001550': ['KOSPI_보통주'],
 'A000480': ['KOSPI_보통주'],
 'A120030': ['KOSPI_보통주'],
 'A018470': ['KOSPI_보통주'],
 'A002600': ['KOSPI_보통주'],
 'A063160': ['KOSPI_보통주'],
 'A185750': ['KOSPI_보통주'],
 'A001630': ['KOSPI_보통주'],
 'A070960': ['KOSPI_보통주'],
 'A023450': ['KOSPI_보통주'],
 'A002380': ['KOSPI_보통주'],
 'A044380': ['KOSPI_보통주'],
 'A024110': ['KOSPI_보통주'],
 'A013890': ['KOSPI_보통주'],
 'A001250': ['KOSPI_보통주'],
 'A007070': ['KOSPI_보통주'],
 'A013870': ['KOSPI_보통주'],
 'A071320': ['KOSPI_보통주'],
 'A010580': ['KOSPI_보통주'],
 'A035000': ['KOSPI_보통주'],
 'A088790': ['KOSPI_보통주'],
 'A003780': ['KOSPI_보통주'],
 'A010640': ['KOSPI_보통주'],
 'A100250': ['KOSPI_보통주'],
 'A051630': ['KOSPI_보통주'],
 'A272450': ['KOSPI_보통주'],
 'A011000': ['KOSPI_보통주'],
 'A002785': ['KOSPI_신형우선주'],
 'A002787': ['KOSPI_신형우선주'],
 'A002780': ['KOSPI_보통주'],
 'A009310': ['KOSPI_보통주'],
 'A000650': ['KOSPI_보통주'],
 'A033250': ['KOSPI_보통주'],
 'A323410': ['KOSPI_보통주'],
 'A035720': ['KOSPI_보통주'],
 'A006380': ['KOSPI_보통주'],
 'A109070': ['KOSPI_보통주'],
 'A001620': ['KOSPI_보통주'],
 'A009440': ['KOSPI_보통주'],
 'A029460': ['KOSPI_보통주'],
 'A344820': ['KOSPI_보통주'],
 'A119650': ['KOSPI_보통주'],
 'A281820': ['KOSPI_보통주'],
 'A044450': ['KOSPI_보통주'],
 'A092220': ['KOSPI_보통주'],
 'A145270': ['KOSPI_보통주'],
 'A030200': ['KOSPI_보통주'],
 'A030210': ['KOSPI_보통주'],
 'A053210': ['KOSPI_보통주'],
 'A058850': ['KOSPI_보통주'],
 'A058860': ['KOSPI_보통주'],
 'A033780': ['KOSPI_보통주'],
 'A357120': ['KOSPI_보통주'],
 'A007815': ['KOSPI_구형우선주'],
 'A00781K': ['KOSPI_종류주권'],
 'A007810': ['KOSPI_보통주'],
 'A003690': ['KOSPI_보통주'],
 'A192820': ['KOSPI_보통주'],
 'A044820': ['KOSPI_보통주'],
 'A005070': ['KOSPI_보통주'],
 'A005420': ['KOSPI_보통주'],
 'A071950': ['KOSPI_보통주'],
 'A002025': ['KOSPI_구형우선주'],
 'A003075': ['KOSPI_구형우선주'],
 'A003070': ['KOSPI_보통주'],
 'A144620': ['KOSPI_보통주'],
 'A002020': ['KOSPI_보통주'],
 'A120115': ['KOSPI_구형우선주'],
 'A120110': ['KOSPI_보통주'],
 'A138490': ['KOSPI_보통주'],
 'A021240': ['KOSPI_보통주'],
 'A031820': ['KOSPI_보통주'],
 'A192400': ['KOSPI_보통주'],
 'A284740': ['KOSPI_보통주'],
 'A015590': ['KOSPI_보통주'],
 'A26490K': ['KOSPI_신형우선주'],
 'A264900': ['KOSPI_보통주'],
 'A005745': ['KOSPI_구형우선주'],
 'A005740': ['KOSPI_보통주'],
 'A259960': ['KOSPI_보통주'],
 'A020120': ['KOSPI_보통주'],
 'A039490': ['KOSPI_보통주'],
 'A014580': ['KOSPI_보통주'],
 'A015890': ['KOSPI_보통주'],
 'A006890': ['KOSPI_보통주'],
 'A003240': ['KOSPI_보통주'],
 'A011280': ['KOSPI_보통주'],
 'A004105': ['KOSPI_구형우선주'],
 'A004100': ['KOSPI_보통주'],
 'A009410': ['KOSPI_보통주'],
 'A009415': ['KOSPI_구형우선주'],
 'A001420': ['KOSPI_보통주'],
 'A007980': ['KOSPI_보통주'],
 'A055490': ['KOSPI_보통주'],
 'A078000': ['KOSPI_보통주'],
 'A214420': ['KOSPI_보통주'],
 'A019180': ['KOSPI_보통주'],
 'A002900': ['KOSPI_보통주'],
 'A36328K': ['KOSPI_종류주권'],
 'A363280': ['KOSPI_보통주'],
 'A091810': ['KOSPI_보통주'],
 'A004870': ['KOSPI_보통주'],
 'A005690': ['KOSPI_보통주'],
 'A036580': ['KOSPI_보통주'],
 'A004720': ['KOSPI_보통주'],
 'A028670': ['KOSPI_보통주'],
 'A010820': ['KOSPI_보통주'],
 'A016800': ['KOSPI_보통주'],
 'A001020': ['KOSPI_보통주'],
 'A090080': ['KOSPI_보통주'],
 'A010770': ['KOSPI_보통주'],
 'A058430': ['KOSPI_보통주'],
 'A005490': ['KOSPI_보통주'],
 'A047050': ['KOSPI_보통주'],
 'A003670': ['KOSPI_보통주'],
 'A007630': ['KOSPI_보통주'],
 'A017810': ['KOSPI_보통주'],
 'A103140': ['KOSPI_보통주'],
 'A005810': ['KOSPI_보통주'],
 'A950210': ['KOSPI_보통주'],
 'A178920': ['KOSPI_보통주'],
 'A086790': ['KOSPI_보통주'],
 'A293480': ['KOSPI_보통주'],
 'A039130': ['KOSPI_보통주'],
 'A172580': ['KOSPI_보통주'],
 'A153360': ['KOSPI_보통주'],
 'A352820': ['KOSPI_보통주'],
 'A071090': ['KOSPI_보통주'],
 'A019490': ['KOSPI_보통주'],
 'A000087': ['KOSPI_신형우선주'],
 'A000080': ['KOSPI_보통주'],
 'A000145': ['KOSPI_구형우선주'],
 'A000140': ['KOSPI_보통주'],
 'A036460': ['KOSPI_보통주'],
 'A005430': ['KOSPI_보통주'],
 'A010040': ['KOSPI_보통주'],
 'A025540': ['KOSPI_보통주'],
 'A096300': ['KOSPI_보통주'],
 'A004090': ['KOSPI_보통주'],
 'A002200': ['KOSPI_보통주'],
 'A002960': ['KOSPI_보통주'],
 'A000240': ['KOSPI_보통주'],
 'A033270': ['KOSPI_보통주'],
 'A123890': ['KOSPI_보통주'],
 'A015760': ['KOSPI_보통주'],
 'A052690': ['KOSPI_보통주'],
 'A006200': ['KOSPI_보통주'],
 'A009540': ['KOSPI_보통주'],
 'A023350': ['KOSPI_보통주'],
 'A025890': ['KOSPI_보통주'],
 'A000970': ['KOSPI_보통주'],
 'A104700': ['KOSPI_보통주'],
 'A017960': ['KOSPI_보통주'],
 'A161890': ['KOSPI_보통주'],
 'A024720': ['KOSPI_보통주'],
 'A161390': ['KOSPI_보통주'],
 'A034830': ['KOSPI_보통주'],
 'A152550': ['KOSPI_보통주'],
 'A168490': ['KOSPI_보통주'],
 'A071055': ['KOSPI_구형우선주'],
 'A071050': ['KOSPI_보통주'],
 'A007280': ['KOSPI_보통주'],
 'A010100': ['KOSPI_보통주'],
 'A047810': ['KOSPI_보통주'],
 'A123690': ['KOSPI_보통주'],
 'A003350': ['KOSPI_보통주'],
 'A011500': ['KOSPI_보통주'],
 'A002390': ['KOSPI_보통주'],
 'A014790': ['KOSPI_보통주'],
 'A060980': ['KOSPI_보통주'],
 'A053690': ['KOSPI_보통주'],
 'A042700': ['KOSPI_보통주'],
 'A008930': ['KOSPI_보통주'],
 'A128940': ['KOSPI_보통주'],
 'A009240': ['KOSPI_보통주'],
 'A020000': ['KOSPI_보통주'],
 'A003680': ['KOSPI_보통주'],
 'A105630': ['KOSPI_보통주'],
 'A069640': ['KOSPI_보통주'],
 'A016450': ['KOSPI_보통주'],
 'A010420': ['KOSPI_보통주'],
 'A009180': ['KOSPI_보통주'],
 'A213500': ['KOSPI_보통주'],
 'A014680': ['KOSPI_보통주'],
 'A004710': ['KOSPI_보통주'],
 'A004150': ['KOSPI_보통주'],
 'A025750': ['KOSPI_보통주'],
 'A004960': ['KOSPI_보통주'],
 'A011700': ['KOSPI_보통주'],
 'A001755': ['KOSPI_구형우선주'],
 'A001750': ['KOSPI_보통주'],
 'A018880': ['KOSPI_보통주'],
 'A009420': ['KOSPI_보통주'],
 'A014130': ['KOSPI_보통주'],
 'A300720': ['KOSPI_보통주'],
 'A002220': ['KOSPI_보통주'],
 'A006390': ['KOSPI_보통주'],
 'A003300': ['KOSPI_보통주'],
 'A051600': ['KOSPI_보통주'],
 'A130660': ['KOSPI_보통주'],
 'A002320': ['KOSPI_보통주'],
 'A097230': ['KOSPI_보통주'],
 'A003480': ['KOSPI_보통주'],
 'A18064K': ['KOSPI_종류주권'],
 'A180640': ['KOSPI_보통주'],
 'A005110': ['KOSPI_보통주'],
 'A009460': ['KOSPI_보통주'],
 'A372910': ['KOSPI_보통주'],
 'A000885': ['KOSPI_구형우선주'],
 'A00088K': ['KOSPI_신형우선주'],
 'A000880': ['KOSPI_보통주'],
 'A088350': ['KOSPI_보통주'],
 'A000370': ['KOSPI_보통주'],
 'A009835': ['KOSPI_구형우선주'],
 'A009830': ['KOSPI_보통주'],
 'A272210': ['KOSPI_보통주'],
 'A012450': ['KOSPI_보통주'],
 'A003535': ['KOSPI_구형우선주'],
 'A003530': ['KOSPI_보통주'],
 'A195870': ['KOSPI_보통주'],
 'A101530': ['KOSPI_보통주'],
 'A143210': ['KOSPI_보통주'],
 'A000725': ['KOSPI_구형우선주'],
 'A267270': ['KOSPI_보통주'],
 'A000720': ['KOSPI_보통주'],
 'A005440': ['KOSPI_보통주'],
 'A086280': ['KOSPI_보통주'],
 'A064350': ['KOSPI_보통주'],
 'A079430': ['KOSPI_보통주'],
 'A012330': ['KOSPI_보통주'],
 'A010620': ['KOSPI_보통주'],
 'A069960': ['KOSPI_보통주'],
 'A004565': ['KOSPI_구형우선주'],
 'A004560': ['KOSPI_보통주'],
 'A004310': ['KOSPI_보통주'],
 'A322000': ['KOSPI_보통주'],
 'A017800': ['KOSPI_보통주'],
 'A307950': ['KOSPI_보통주'],
 'A011210': ['KOSPI_보통주'],
 'A267260': ['KOSPI_보통주'],
 'A005385': ['KOSPI_구형우선주'],
 'A005387': ['KOSPI_신형우선주'],
 'A005389': ['KOSPI_신형우선주'],
 'A005380': ['KOSPI_보통주'],
 'A004020': ['KOSPI_보통주'],
 'A329180': ['KOSPI_보통주'],
 'A267250': ['KOSPI_보통주'],
 'A001500': ['KOSPI_보통주'],
 'A011760': ['KOSPI_보통주'],
 'A227840': ['KOSPI_보통주'],
 'A126560': ['KOSPI_보통주'],
 'A001450': ['KOSPI_보통주'],
 'A057050': ['KOSPI_보통주'],
 'A093240': ['KOSPI_보통주'],
 'A003010': ['KOSPI_보통주'],
 'A111110': ['KOSPI_보통주'],
 'A008775': ['KOSPI_구형우선주'],
 'A008770': ['KOSPI_보통주'],
 'A002460': ['KOSPI_보통주'],
 'A378850': ['KOSPI_보통주'],
 'A241590': ['KOSPI_보통주'],
 'A006060': ['KOSPI_보통주'],
 'A013520': ['KOSPI_보통주'],
 'A010690': ['KOSPI_보통주'],
 'A133820': ['KOSPI_보통주'],
 'A010660': ['KOSPI_보통주'],
 'A000850': ['KOSPI_보통주'],
 'A016580': ['KOSPI_보통주'],
 'A032560': ['KOSPI_보통주'],
 'A004800': ['KOSPI_보통주'],
 'A094280': ['KOSPI_보통주'],
 'A298040': ['KOSPI_보통주'],
 'A298050': ['KOSPI_보통주'],
 'A298020': ['KOSPI_보통주'],
 'A298000': ['KOSPI_보통주'],
 'A093370': ['KOSPI_보통주'],
 'A081660': ['KOSPI_보통주'],
 'A005870': ['KOSPI_보통주'],
 'A079980': ['KOSPI_보통주'],
 'A005010': ['KOSPI_보통주'],
 'A069260': ['KOSPI_보통주'],
 'A000545': ['KOSPI_구형우선주'],
 'A000547': ['KOSPI_신형우선주'],
 'A000540': ['KOSPI_보통주'],
 'A003280': ['KOSPI_보통주'],
 'A098120': ['KOSDAQ_보통주_벤처기업부'],
 'A131100': ['KOSDAQ_보통주_투자주의환기종목(소속부없음)'],
 'A009520': ['KOSDAQ_보통주_우량기업부'],
 'A058820': ['KOSDAQ_보통주_우량기업부'],
 'A050120': ['KOSDAQ_보통주_중견기업부'],
 'A024120': ['KOSDAQ_보통주_우량기업부'],
 'A044180': ['KOSDAQ_보통주_중견기업부'],
 'A950110': ['KOSDAQ_보통주_외국기업(소속부없음)'],
 'A079940': ['KOSDAQ_보통주_우량기업부'],
 'A078890': ['KOSDAQ_보통주_우량기업부'],
 'A036620': ['KOSDAQ_보통주_중견기업부'],
 'A217730': ['KOSDAQ_보통주_기술성장기업부'],
 'A114190': ['KOSDAQ_보통주_관리종목(소속부없음)'],
 'A094480': ['KOSDAQ_보통주_우량기업부'],
 'A063080': ['KOSDAQ_보통주_우량기업부'],
 'A039240': ['KOSDAQ_보통주_우량기업부'],
 'A053950': ['KOSDAQ_보통주_중견기업부'],
 'A223310': ['KOSDAQ_보통주_관리종목(소속부없음)'],
 'A011040': ['KOSDAQ_보통주_우량기업부'],
 'A024910': ['KOSDAQ_보통주_중견기업부'],
 'A198440': ['KOSDAQ_보통주_우량기업부'],
 'A049720': ['KOSDAQ_보통주_중견기업부'],
 'A014570': ['KOSDAQ_보통주_우량기업부'],
 'A348150': ['KOSDAQ_보통주_기술성장기업부'],
 'A098460': ['KOSDAQ_보통주_우량기업부'],
 'A035290': ['KOSDAQ_보통주_관리종목(소속부없음)'],
 'A038530': ['KOSDAQ_보통주_중견기업부'],
 'A215000': ['KOSDAQ_보통주_우량기업부'],
 'A121440': ['KOSDAQ_보통주_중견기업부'],
 'A014200': ['KOSDAQ_보통주_중견기업부'],
 'A026910': ['KOSDAQ_보통주_중견기업부'],
 'A090150': ['KOSDAQ_보통주_중견기업부'],
 'A355150': ['KOSDAQ_보통주_SPAC(소속부없음)'],
 'A331520': ['KOSDAQ_보통주_SPAC(소속부없음)'],
 'A053270': ['KOSDAQ_보통주_중견기업부'],
 'A066620': ['KOSDAQ_보통주_우량기업부'],
 'A043650': ['KOSDAQ_보통주_우량기업부'],
 'A006050': ['KOSDAQ_보통주_중견기업부'],
 'A060480': ['KOSDAQ_보통주_중견기업부'],
 'A078130': ['KOSDAQ_보통주_중견기업부'],
 'A307750': ['KOSDAQ_보통주_우량기업부'],
 'A900290': ['KOSDAQ_보통주_관리종목(소속부없음)'],
 'A204020': ['KOSDAQ_보통주_중견기업부'],
 'A186230': ['KOSDAQ_보통주_벤처기업부'],
 'A083450': ['KOSDAQ_보통주_우량기업부'],
 'A900070': ['KOSDAQ_보통주_외국기업(소속부없음)'],
 'A204620': ['KOSDAQ_보통주_중견기업부'],
 'A019660': ['KOSDAQ_보통주_중견기업부'],
 'A053260': ['KOSDAQ_보통주_우량기업부'],
 'A045890': ['KOSDAQ_보통주_관리종목(소속부없음)'],
 'A036190': ['KOSDAQ_보통주_우량기업부'],
 'A049080': ['KOSDAQ_보통주_중견기업부'],
 'A035460': ['KOSDAQ_보통주_벤처기업부'],
 'A308100': ['KOSDAQ_보통주_우량기업부'],
 'A187790': ['KOSDAQ_보통주_벤처기업부'],
 'A286750': ['KOSDAQ_보통주_기술성장기업부'],
 'A151910': ['KOSDAQ_보통주_중견기업부'],
 'A121600': ['KOSDAQ_보통주_벤처기업부'],
 'A247660': ['KOSDAQ_보통주_기술성장기업부'],
 'A039860': ['KOSDAQ_보통주_중견기업부'],
 'A091970': ['KOSDAQ_보통주_벤처기업부'],
 'A051490': ['KOSDAQ_보통주_중견기업부'],
 ...}
</pre>
### 3.2.3. 사전 값으로 대체



```python
for i in tqdm(f_hold_name.columns) :
    f_hold_name[i] = f_hold_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(f_hold_name.columns) :
    f_hold_name[i] = f_hold_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(f_hold_name.columns):
    f_hold_name[i] = f_hold_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_hold_name.nunique().index):
    unique = f_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [18:57<00:00, 94.75s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 65.70it/s]
</pre>
<pre>
{'0',
 2e-323,
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타'}
</pre>

```python
f_hold_name.isnull().sum()
```

<pre>
주식보유1위종목_202006    0
주식보유1위종목_202007    0
주식보유1위종목_202008    0
주식보유1위종목_202009    0
주식보유1위종목_202010    0
주식보유1위종목_202011    0
주식보유1위종목_202012    0
주식보유1위종목_202101    0
주식보유1위종목_202102    0
주식보유1위종목_202103    0
주식보유1위종목_202104    0
주식보유1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_hold_name.columns) :
    s_hold_name[i] = s_hold_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(s_hold_name.columns) :
    s_hold_name[i] = s_hold_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(s_hold_name.columns):
    s_hold_name[i] = s_hold_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_hold_name.nunique().index):
    unique = s_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [16:57<00:00, 84.79s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 68.36it/s]
</pre>
<pre>
{'0',
 2e-323,
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타'}
</pre>

```python
s_hold_name.isnull().sum()
```

<pre>
주식보유2위종목_202006    0
주식보유2위종목_202007    0
주식보유2위종목_202008    0
주식보유2위종목_202009    0
주식보유2위종목_202010    0
주식보유2위종목_202011    0
주식보유2위종목_202012    0
주식보유2위종목_202101    0
주식보유2위종목_202102    0
주식보유2위종목_202103    0
주식보유2위종목_202104    0
주식보유2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_hold_name.columns) :
    t_hold_name[i] = t_hold_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(t_hold_name.columns) :
    t_hold_name[i] = t_hold_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(t_hold_name.columns):
    t_hold_name[i] = t_hold_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_hold_name.nunique().index):
    unique = t_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [15:17<00:00, 76.46s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 71.62it/s]
</pre>
<pre>
{'0',
 2e-323,
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타'}
</pre>

```python
t_hold_name.isnull().sum()
```

<pre>
주식보유3위종목_202006    0
주식보유3위종목_202007    0
주식보유3위종목_202008    0
주식보유3위종목_202009    0
주식보유3위종목_202010    0
주식보유3위종목_202011    0
주식보유3위종목_202012    0
주식보유3위종목_202101    0
주식보유3위종목_202102    0
주식보유3위종목_202103    0
주식보유3위종목_202104    0
주식보유3위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(f_buy_name.columns) :
    f_buy_name[i] = f_buy_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(f_buy_name.columns) :
    f_buy_name[i] = f_buy_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(f_buy_name.columns):
    f_buy_name[i] = f_buy_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_buy_name.nunique().index):
    unique = f_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [15:59<00:00, 79.92s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 70.35it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
f_buy_name.isnull().sum()
```

<pre>
주식매수1위종목_202006    0
주식매수1위종목_202007    0
주식매수1위종목_202008    0
주식매수1위종목_202009    0
주식매수1위종목_202010    0
주식매수1위종목_202011    0
주식매수1위종목_202012    0
주식매수1위종목_202101    0
주식매수1위종목_202102    0
주식매수1위종목_202103    0
주식매수1위종목_202104    0
주식매수1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_buy_name.columns) :
    s_buy_name[i] = s_buy_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(s_buy_name.columns) :
    s_buy_name[i] = s_buy_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(s_buy_name.columns):
    s_buy_name[i] = s_buy_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_buy_name.nunique().index):
    unique = s_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [14:04<00:00, 70.40s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 74.73it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
s_buy_name.isnull().sum()
```

<pre>
주식매수2위종목_202006    0
주식매수2위종목_202007    0
주식매수2위종목_202008    0
주식매수2위종목_202009    0
주식매수2위종목_202010    0
주식매수2위종목_202011    0
주식매수2위종목_202012    0
주식매수2위종목_202101    0
주식매수2위종목_202102    0
주식매수2위종목_202103    0
주식매수2위종목_202104    0
주식매수2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_buy_name.columns) :
    t_buy_name[i] = t_buy_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(t_buy_name.columns) :
    t_buy_name[i] = t_buy_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(t_buy_name.columns):
    t_buy_name[i] = t_buy_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_buy_name.nunique().index):
    unique = t_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [12:24<00:00, 62.04s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 79.67it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
t_buy_name.isnull().sum()
```

<pre>
주식매수3위종목_202006    0
주식매수3위종목_202007    0
주식매수3위종목_202008    0
주식매수3위종목_202009    0
주식매수3위종목_202010    0
주식매수3위종목_202011    0
주식매수3위종목_202012    0
주식매수3위종목_202101    0
주식매수3위종목_202102    0
주식매수3위종목_202103    0
주식매수3위종목_202104    0
주식매수3위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(f_sell_name.columns) :
    f_sell_name[i] = f_sell_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(f_sell_name.columns) :
    f_sell_name[i] = f_sell_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(f_sell_name.columns):
    f_sell_name[i] = f_sell_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_sell_name.nunique().index):
    unique = f_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [14:48<00:00, 74.07s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 72.47it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
f_sell_name.isnull().sum()
```

<pre>
주식매도1위종목_202006    0
주식매도1위종목_202007    0
주식매도1위종목_202008    0
주식매도1위종목_202009    0
주식매도1위종목_202010    0
주식매도1위종목_202011    0
주식매도1위종목_202012    0
주식매도1위종목_202101    0
주식매도1위종목_202102    0
주식매도1위종목_202103    0
주식매도1위종목_202104    0
주식매도1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_sell_name.columns) :
    s_sell_name[i] = s_sell_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(s_sell_name.columns) :
    s_sell_name[i] = s_sell_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(s_sell_name.columns):
    s_sell_name[i] = s_sell_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_sell_name.nunique().index):
    unique = s_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [12:28<00:00, 62.41s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 75.60it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
s_sell_name.isnull().sum()
```

<pre>
주식매도2위종목_202006    0
주식매도2위종목_202007    0
주식매도2위종목_202008    0
주식매도2위종목_202009    0
주식매도2위종목_202010    0
주식매도2위종목_202011    0
주식매도2위종목_202012    0
주식매도2위종목_202101    0
주식매도2위종목_202102    0
주식매도2위종목_202103    0
주식매도2위종목_202104    0
주식매도2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_sell_name.columns) :
    t_sell_name[i] = t_sell_name[i].replace(type_dic)
    
# 용어 통일
uni_dic = {'KOSPI_구형우선주':'KOSPI_우선주', 
       'KOSPI_신형우선주':'KOSPI_우선주',
      'KOSDAQ_보통주_투자주의환기종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_관리종목(소속부없음)':'KOSDAQ_보통주_관리 및 투자주의환기종목', 
       'KOSDAQ_보통주_외국기업(소속부없음)':'KOSDAQ_보통주_외국기업', 
       'KOSDAQ_보통주_SPAC(소속부없음)':'KOSDAQ_보통주_SPAC',
      'KOSDAQ_신형우선주_중견기업부' : 'KOSDAQ_우선주_중견기업부',
      'KOSDAQ_종류주권_투자주의환기종목(소속부없음)' : 'KOSDAQ_종류주권_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_관리종목' :  'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'KOSDAQ_보통주_투자주의환기종목' : 'KOSDAQ_보통주_관리 및 투자주의환기종목',
      'USA' : '해외'}

for i in tqdm(t_sell_name.columns) :
    t_sell_name[i] = t_sell_name[i].replace(uni_dic)
    
type = ['ETF', 'ELW', 'ETN', 
        'KOSDAQ_보통주_SPAC','KOSDAQ_보통주_관리 및 투자주의환기종목', 
        'KOSDAQ_보통주_기술성장기업부','KOSDAQ_보통주_벤처기업부',
        'KOSDAQ_보통주_외국기업','KOSDAQ_보통주_우량기업부',
        'KOSDAQ_보통주_중견기업부',
        'KOSDAQ_우선주_SPAC','KOSDAQ_우선주_관리 및 투자주의환기종목', 
        'KOSDAQ_우선주_기술성장기업부','KOSDAQ_우선주_벤처기업부',
        'KOSDAQ_우선주_외국기업','KOSDAQ_우선주_우량기업부',
        'KOSDAQ_우선주_중견기업부',
        'KOSDAQ_종류주권_SPAC','KOSDAQ_종류주권_관리 및 투자주의환기종목', 
        'KOSDAQ_종류주권_기술성장기업부','KOSDAQ_종류주권_벤처기업부',
        'KOSDAQ_종류주권_외국기업','KOSDAQ_종류주권_우량기업부',
        'KOSDAQ_종류주권_중견기업부', 'KOSPI_보통주', 'KOSPI_우선주',
        'KOSPI_종류주권','기타', '해외', '0']

for i in tqdm(t_sell_name.columns):
    t_sell_name[i] = t_sell_name[i].apply(lambda x: '기타' if x not in type else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_sell_name.nunique().index):
    unique = t_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [11:06<00:00, 55.57s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00,  9.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 78.12it/s]
</pre>
<pre>
{'0',
 2e-323,
 'ETF',
 'KOSDAQ_보통주_SPAC',
 'KOSDAQ_보통주_관리 및 투자주의환기종목',
 'KOSDAQ_보통주_기술성장기업부',
 'KOSDAQ_보통주_벤처기업부',
 'KOSDAQ_보통주_외국기업',
 'KOSDAQ_보통주_우량기업부',
 'KOSDAQ_보통주_중견기업부',
 'KOSDAQ_우선주_중견기업부',
 'KOSPI_보통주',
 'KOSPI_우선주',
 'KOSPI_종류주권',
 '기타',
 '해외'}
</pre>

```python
t_sell_name.isnull().sum()
```

<pre>
주식매도3위종목_202006    0
주식매도3위종목_202007    0
주식매도3위종목_202008    0
주식매도3위종목_202009    0
주식매도3위종목_202010    0
주식매도3위종목_202011    0
주식매도3위종목_202012    0
주식매도3위종목_202101    0
주식매도3위종목_202102    0
주식매도3위종목_202103    0
주식매도3위종목_202104    0
주식매도3위종목_202105    0
dtype: int64
</pre>
## 3.3. 관심산업(GICS) 정보


### 3.3.1. 외부데이터 불러오기



```python
dic_ks2 = pd.read_csv('한국_GICS_최종.csv', engine='python', encoding = 'CP949')
dic_usa2 = pd.read_csv('USA_GICS_최종.csv', engine='python', encoding = 'CP949')
```

### 3.3.2. 산업분류 사전



```python
dic_ks2 = dic_ks2.set_index('종목코드').T.to_dict('list')
dic_usa2 = dic_usa2.set_index('기호').T.to_dict('list')
```


```python
#추가 GICS
add_gics = add[['종목코드','GICS']]
add_gics = add_gics.set_index('종목코드').T.to_dict('list')
```

<pre>
<ipython-input-99-719dfbe346d5>:3: UserWarning: DataFrame columns are not unique, some columns will be omitted.
  add_gics = add_gics.set_index('종목코드').T.to_dict('list')
</pre>

```python
print(len(dic_ks2)+ len(dic_usa2)+ len(add_gics))
```

<pre>
2773
</pre>

```python
len({**dic_ks2, **dic_usa2, **add_gics})
```

<pre>
2773
</pre>

```python
gics_dic = {**dic_ks2, **dic_usa2, **add_gics}
```

### 3.3.3. 사전 값으로 대체



```python
for i in tqdm(f_hold_name.columns) :
    f_hold_name[i] = f_hold_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(f_hold_name.columns):
    f_hold_name[i] = f_hold_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_hold_name.nunique().index):
    unique = f_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:16<00:00, 11.41s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 79.14it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
f_hold_name.isnull().sum()
```

<pre>
주식보유1위종목_202006    0
주식보유1위종목_202007    0
주식보유1위종목_202008    0
주식보유1위종목_202009    0
주식보유1위종목_202010    0
주식보유1위종목_202011    0
주식보유1위종목_202012    0
주식보유1위종목_202101    0
주식보유1위종목_202102    0
주식보유1위종목_202103    0
주식보유1위종목_202104    0
주식보유1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_hold_name.columns) :
    s_hold_name[i] = s_hold_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(s_hold_name.columns):
    s_hold_name[i] = s_hold_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_hold_name.nunique().index):
    unique = s_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:16<00:00, 11.38s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 82.39it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
s_hold_name.isnull().sum()
```

<pre>
주식보유2위종목_202006    0
주식보유2위종목_202007    0
주식보유2위종목_202008    0
주식보유2위종목_202009    0
주식보유2위종목_202010    0
주식보유2위종목_202011    0
주식보유2위종목_202012    0
주식보유2위종목_202101    0
주식보유2위종목_202102    0
주식보유2위종목_202103    0
주식보유2위종목_202104    0
주식보유2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_hold_name.columns) :
    t_hold_name[i] = t_hold_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(t_hold_name.columns):
    t_hold_name[i] = t_hold_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_hold_name.nunique().index):
    unique = t_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.10s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 83.54it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
t_hold_name.isnull().sum()
```

<pre>
주식보유3위종목_202006    0
주식보유3위종목_202007    0
주식보유3위종목_202008    0
주식보유3위종목_202009    0
주식보유3위종목_202010    0
주식보유3위종목_202011    0
주식보유3위종목_202012    0
주식보유3위종목_202101    0
주식보유3위종목_202102    0
주식보유3위종목_202103    0
주식보유3위종목_202104    0
주식보유3위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(f_buy_name.columns) :
    f_buy_name[i] = f_buy_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(f_buy_name.columns):
    f_buy_name[i] = f_buy_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_buy_name.nunique().index):
    unique = f_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.16s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 82.41it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
f_buy_name.isnull().sum()
```

<pre>
주식매수1위종목_202006    0
주식매수1위종목_202007    0
주식매수1위종목_202008    0
주식매수1위종목_202009    0
주식매수1위종목_202010    0
주식매수1위종목_202011    0
주식매수1위종목_202012    0
주식매수1위종목_202101    0
주식매수1위종목_202102    0
주식매수1위종목_202103    0
주식매수1위종목_202104    0
주식매수1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_buy_name.columns) :
    s_buy_name[i] = s_buy_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(s_buy_name.columns):
    s_buy_name[i] = s_buy_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_buy_name.nunique().index):
    unique = s_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.09s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 89.79it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
s_buy_name.isnull().sum()
```

<pre>
주식매수2위종목_202006    0
주식매수2위종목_202007    0
주식매수2위종목_202008    0
주식매수2위종목_202009    0
주식매수2위종목_202010    0
주식매수2위종목_202011    0
주식매수2위종목_202012    0
주식매수2위종목_202101    0
주식매수2위종목_202102    0
주식매수2위종목_202103    0
주식매수2위종목_202104    0
주식매수2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_buy_name.columns) :
    t_buy_name[i] = t_buy_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(t_buy_name.columns):
    t_buy_name[i] = t_buy_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_buy_name.nunique().index):
    unique = t_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.12s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 84.41it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
t_buy_name.isnull().sum()
```

<pre>
주식매수3위종목_202006    0
주식매수3위종목_202007    0
주식매수3위종목_202008    0
주식매수3위종목_202009    0
주식매수3위종목_202010    0
주식매수3위종목_202011    0
주식매수3위종목_202012    0
주식매수3위종목_202101    0
주식매수3위종목_202102    0
주식매수3위종목_202103    0
주식매수3위종목_202104    0
주식매수3위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(f_sell_name.columns) :
    f_sell_name[i] = f_sell_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(f_sell_name.columns):
    f_sell_name[i] = f_sell_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(f_sell_name.nunique().index):
    unique = f_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:12<00:00, 11.07s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 84.14it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
f_sell_name.isnull().sum()
```

<pre>
주식매도1위종목_202006    0
주식매도1위종목_202007    0
주식매도1위종목_202008    0
주식매도1위종목_202009    0
주식매도1위종목_202010    0
주식매도1위종목_202011    0
주식매도1위종목_202012    0
주식매도1위종목_202101    0
주식매도1위종목_202102    0
주식매도1위종목_202103    0
주식매도1위종목_202104    0
주식매도1위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(s_sell_name.columns) :
    s_sell_name[i] = s_sell_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(s_sell_name.columns):
    s_sell_name[i] = s_sell_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(s_sell_name.nunique().index):
    unique = s_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.10s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 86.56it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
s_sell_name.isnull().sum()
```

<pre>
주식매도2위종목_202006    0
주식매도2위종목_202007    0
주식매도2위종목_202008    0
주식매도2위종목_202009    0
주식매도2위종목_202010    0
주식매도2위종목_202011    0
주식매도2위종목_202012    0
주식매도2위종목_202101    0
주식매도2위종목_202102    0
주식매도2위종목_202103    0
주식매도2위종목_202104    0
주식매도2위종목_202105    0
dtype: int64
</pre>

```python
for i in tqdm(t_sell_name.columns) :
    t_sell_name[i] = t_sell_name[i].replace(gics_dic)
    
gics = ['금융', '부동산', '산업', '소재', '에너지', '유틸리티', '임의소비재', 
        '정보기술', '커뮤니케이션서비스', '필수소비재', '헬스케어', '0']

for i in tqdm(t_sell_name.columns):
    t_sell_name[i] = t_sell_name[i].apply(lambda x: '기타' if x not in gics else x)
    
blink = np.empty(shape=1)

for i in tqdm(t_sell_name.nunique().index):
    unique = t_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [02:13<00:00, 11.14s/it]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 89.79it/s]
</pre>
<pre>
{'0', 2e-323, '기타'}
</pre>

```python
t_sell_name.isnull().sum()
```

<pre>
주식매도3위종목_202006    0
주식매도3위종목_202007    0
주식매도3위종목_202008    0
주식매도3위종목_202009    0
주식매도3위종목_202010    0
주식매도3위종목_202011    0
주식매도3위종목_202012    0
주식매도3위종목_202101    0
주식매도3위종목_202102    0
주식매도3위종목_202103    0
주식매도3위종목_202104    0
주식매도3위종목_202105    0
dtype: int64
</pre>
## 3.4. 관심종목 PER


### 3.4.1. 외부데이터 불러오기



```python
PER_20200630 = pd.read_csv('PER_20200630.csv', engine='python', encoding = 'CP949')
PER_20200731 = pd.read_csv('PER_20200731.csv', engine='python', encoding = 'CP949')
PER_20200831 = pd.read_csv('PER_20200831.csv', engine='python', encoding = 'CP949')
PER_20200929 = pd.read_csv('PER_20200929.csv', engine='python', encoding = 'CP949')
PER_20201030 = pd.read_csv('PER_20201030.csv', engine='python', encoding = 'CP949')
PER_20201130 = pd.read_csv('PER_20201130.csv', engine='python', encoding = 'CP949')
PER_20201230 = pd.read_csv('PER_20201230.csv', engine='python', encoding = 'CP949')
PER_20210129 = pd.read_csv('PER_20210129.csv', engine='python', encoding = 'CP949')
PER_20210226 = pd.read_csv('PER_20210226.csv', engine='python', encoding = 'CP949')
PER_20210331 = pd.read_csv('PER_20210331.csv', engine='python', encoding = 'CP949')
PER_20210430 = pd.read_csv('PER_20210430.csv', engine='python', encoding = 'CP949')
PER_20210531 = pd.read_csv('PER_20210531.csv', engine='python', encoding = 'CP949')
```

### 3.4.2. PER 사전



```python
dic_per20200630 = PER_20200630[['종목코드','PER']]
dic_per20200731 = PER_20200731[['종목코드','PER']]
dic_per20200831 = PER_20200831[['종목코드','PER']]
dic_per20200929 = PER_20200929[['종목코드','PER']]
dic_per20201030 = PER_20201030[['종목코드','PER']]
dic_per20201130 = PER_20201130[['종목코드','PER']]
dic_per20201230 = PER_20201230[['종목코드','PER']]
dic_per20210129 = PER_20210129[['종목코드','PER']]
dic_per20210226 = PER_20210226[['종목코드','PER']]
dic_per20210331 = PER_20210331[['종목코드','PER']]
dic_per20210430 = PER_20210430[['종목코드','PER']]
dic_per20210531 = PER_20210531[['종목코드','PER']]
```


```python
for i in range(len(dic_per20200630)) :
    dic_per20200630['종목코드'][i] = 'A'+str(dic_per20200630['종목코드'][i])
for i in range(len(dic_per20200731)) :
    dic_per20200731['종목코드'][i] = 'A'+str(dic_per20200731['종목코드'][i])
for i in range(len(dic_per20200831)) :
    dic_per20200831['종목코드'][i] = 'A'+str(dic_per20200831['종목코드'][i])
for i in range(len(dic_per20200929)) :
    dic_per20200929['종목코드'][i] = 'A'+str(dic_per20200929['종목코드'][i])
for i in range(len(dic_per20201030)) :
    dic_per20201030['종목코드'][i] = 'A'+str(dic_per20201030['종목코드'][i])
for i in range(len(dic_per20201130)) :
    dic_per20201130['종목코드'][i] = 'A'+str(dic_per20201130['종목코드'][i])
for i in range(len(dic_per20201230)) :
    dic_per20201230['종목코드'][i] = 'A'+str(dic_per20201230['종목코드'][i])
for i in range(len(dic_per20210129)) :
    dic_per20210129['종목코드'][i] = 'A'+str(dic_per20210129['종목코드'][i])
for i in range(len(dic_per20210226)) :
    dic_per20210226['종목코드'][i] = 'A'+str(dic_per20210226['종목코드'][i])
for i in range(len(dic_per20210331)) :
    dic_per20210331['종목코드'][i] = 'A'+str(dic_per20210331['종목코드'][i])
for i in range(len(dic_per20210430)) :
    dic_per20210430['종목코드'][i] = 'A'+str(dic_per20210430['종목코드'][i])
for i in range(len(dic_per20210531)) :
    dic_per20210531['종목코드'][i] = 'A'+str(dic_per20210531['종목코드'][i])
```

<pre>
<ipython-input-124-8563703b6691>:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20200630['종목코드'][i] = 'A'+str(dic_per20200630['종목코드'][i])
<ipython-input-124-8563703b6691>:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20200731['종목코드'][i] = 'A'+str(dic_per20200731['종목코드'][i])
<ipython-input-124-8563703b6691>:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20200831['종목코드'][i] = 'A'+str(dic_per20200831['종목코드'][i])
<ipython-input-124-8563703b6691>:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20200929['종목코드'][i] = 'A'+str(dic_per20200929['종목코드'][i])
<ipython-input-124-8563703b6691>:10: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20201030['종목코드'][i] = 'A'+str(dic_per20201030['종목코드'][i])
<ipython-input-124-8563703b6691>:12: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20201130['종목코드'][i] = 'A'+str(dic_per20201130['종목코드'][i])
<ipython-input-124-8563703b6691>:14: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20201230['종목코드'][i] = 'A'+str(dic_per20201230['종목코드'][i])
<ipython-input-124-8563703b6691>:16: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20210129['종목코드'][i] = 'A'+str(dic_per20210129['종목코드'][i])
<ipython-input-124-8563703b6691>:18: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20210226['종목코드'][i] = 'A'+str(dic_per20210226['종목코드'][i])
<ipython-input-124-8563703b6691>:20: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20210331['종목코드'][i] = 'A'+str(dic_per20210331['종목코드'][i])
<ipython-input-124-8563703b6691>:22: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20210430['종목코드'][i] = 'A'+str(dic_per20210430['종목코드'][i])
<ipython-input-124-8563703b6691>:24: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dic_per20210531['종목코드'][i] = 'A'+str(dic_per20210531['종목코드'][i])
</pre>

```python
dic_per20200630 = dic_per20200630.set_index('종목코드').T.to_dict('list')
dic_per20200731 = dic_per20200731.set_index('종목코드').T.to_dict('list')
dic_per20200831 = dic_per20200831.set_index('종목코드').T.to_dict('list')
dic_per20200929 = dic_per20200929.set_index('종목코드').T.to_dict('list')
dic_per20201030 = dic_per20201030.set_index('종목코드').T.to_dict('list')
dic_per20201130 = dic_per20201130.set_index('종목코드').T.to_dict('list')
dic_per20201230 = dic_per20201230.set_index('종목코드').T.to_dict('list')
dic_per20210129 = dic_per20210129.set_index('종목코드').T.to_dict('list')
dic_per20210226 = dic_per20210226.set_index('종목코드').T.to_dict('list')
dic_per20210331 = dic_per20210331.set_index('종목코드').T.to_dict('list')
dic_per20210430 = dic_per20210430.set_index('종목코드').T.to_dict('list')
dic_per20210531 = dic_per20210531.set_index('종목코드').T.to_dict('list')
```

### 3.4.3. 사전 값으로 대체



```python
f_hold_name['주식보유1위종목_202006'] = f_hold_name['주식보유1위종목_202006'].replace(dic_per20200630)
f_hold_name['주식보유1위종목_202007'] = f_hold_name['주식보유1위종목_202007'].replace(dic_per20200731)
f_hold_name['주식보유1위종목_202008'] = f_hold_name['주식보유1위종목_202008'].replace(dic_per20200831)
f_hold_name['주식보유1위종목_202009'] = f_hold_name['주식보유1위종목_202009'].replace(dic_per20200929)
f_hold_name['주식보유1위종목_202010'] = f_hold_name['주식보유1위종목_202010'].replace(dic_per20201030)
f_hold_name['주식보유1위종목_202011'] = f_hold_name['주식보유1위종목_202011'].replace(dic_per20201130)
f_hold_name['주식보유1위종목_202012'] = f_hold_name['주식보유1위종목_202012'].replace(dic_per20201230)
f_hold_name['주식보유1위종목_202101'] = f_hold_name['주식보유1위종목_202101'].replace(dic_per20210129)
f_hold_name['주식보유1위종목_202102'] = f_hold_name['주식보유1위종목_202102'].replace(dic_per20210226)
f_hold_name['주식보유1위종목_202103'] = f_hold_name['주식보유1위종목_202103'].replace(dic_per20210331)
f_hold_name['주식보유1위종목_202104'] = f_hold_name['주식보유1위종목_202104'].replace(dic_per20210430)
f_hold_name['주식보유1위종목_202105'] = f_hold_name['주식보유1위종목_202105'].replace(dic_per20210531)

f_hold_name = f_hold_name.fillna(0)
f_hold_name = f_hold_name.apply(pd.to_numeric, errors = 'coerce')
f_hold_name = f_hold_name.fillna(0)

blink = np.empty(shape=1)

for i in f_hold_name.nunique().index:
    unique = f_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
s_hold_name['주식보유2위종목_202006'] = s_hold_name['주식보유2위종목_202006'].replace(dic_per20200630)
s_hold_name['주식보유2위종목_202007'] = s_hold_name['주식보유2위종목_202007'].replace(dic_per20200731)
s_hold_name['주식보유2위종목_202008'] = s_hold_name['주식보유2위종목_202008'].replace(dic_per20200831)
s_hold_name['주식보유2위종목_202009'] = s_hold_name['주식보유2위종목_202009'].replace(dic_per20200929)
s_hold_name['주식보유2위종목_202010'] = s_hold_name['주식보유2위종목_202010'].replace(dic_per20201030)
s_hold_name['주식보유2위종목_202011'] = s_hold_name['주식보유2위종목_202011'].replace(dic_per20201130)
s_hold_name['주식보유2위종목_202012'] = s_hold_name['주식보유2위종목_202012'].replace(dic_per20201230)
s_hold_name['주식보유2위종목_202101'] = s_hold_name['주식보유2위종목_202101'].replace(dic_per20210129)
s_hold_name['주식보유2위종목_202102'] = s_hold_name['주식보유2위종목_202102'].replace(dic_per20210226)
s_hold_name['주식보유2위종목_202103'] = s_hold_name['주식보유2위종목_202103'].replace(dic_per20210331)
s_hold_name['주식보유2위종목_202104'] = s_hold_name['주식보유2위종목_202104'].replace(dic_per20210430)
s_hold_name['주식보유2위종목_202105'] = s_hold_name['주식보유2위종목_202105'].replace(dic_per20210531)

s_hold_name = s_hold_name.fillna(0)
s_hold_name = s_hold_name.apply(pd.to_numeric, errors = 'coerce')
s_hold_name = s_hold_name.fillna(0)

blink = np.empty(shape=1)

for i in s_hold_name.nunique().index:
    unique = s_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
t_hold_name['주식보유3위종목_202006'] = t_hold_name['주식보유3위종목_202006'].replace(dic_per20200630)
t_hold_name['주식보유3위종목_202007'] = t_hold_name['주식보유3위종목_202007'].replace(dic_per20200731)
t_hold_name['주식보유3위종목_202008'] = t_hold_name['주식보유3위종목_202008'].replace(dic_per20200831)
t_hold_name['주식보유3위종목_202009'] = t_hold_name['주식보유3위종목_202009'].replace(dic_per20200929)
t_hold_name['주식보유3위종목_202010'] = t_hold_name['주식보유3위종목_202010'].replace(dic_per20201030)
t_hold_name['주식보유3위종목_202011'] = t_hold_name['주식보유3위종목_202011'].replace(dic_per20201130)
t_hold_name['주식보유3위종목_202012'] = t_hold_name['주식보유3위종목_202012'].replace(dic_per20201230)
t_hold_name['주식보유3위종목_202101'] = t_hold_name['주식보유3위종목_202101'].replace(dic_per20210129)
t_hold_name['주식보유3위종목_202102'] = t_hold_name['주식보유3위종목_202102'].replace(dic_per20210226)
t_hold_name['주식보유3위종목_202103'] = t_hold_name['주식보유3위종목_202103'].replace(dic_per20210331)
t_hold_name['주식보유3위종목_202104'] = t_hold_name['주식보유3위종목_202104'].replace(dic_per20210430)
t_hold_name['주식보유3위종목_202105'] = t_hold_name['주식보유3위종목_202105'].replace(dic_per20210531)

t_hold_name = t_hold_name.fillna(0)
t_hold_name = t_hold_name.apply(pd.to_numeric, errors = 'coerce')
t_hold_name = t_hold_name.fillna(0)

blink = np.empty(shape=1)

for i in t_hold_name.nunique().index:
    unique = t_hold_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
f_buy_name['주식매수1위종목_202006'] = f_buy_name['주식매수1위종목_202006'].replace(dic_per20200630)
f_buy_name['주식매수1위종목_202007'] = f_buy_name['주식매수1위종목_202007'].replace(dic_per20200731)
f_buy_name['주식매수1위종목_202008'] = f_buy_name['주식매수1위종목_202008'].replace(dic_per20200831)
f_buy_name['주식매수1위종목_202009'] = f_buy_name['주식매수1위종목_202009'].replace(dic_per20200929)
f_buy_name['주식매수1위종목_202010'] = f_buy_name['주식매수1위종목_202010'].replace(dic_per20201030)
f_buy_name['주식매수1위종목_202011'] = f_buy_name['주식매수1위종목_202011'].replace(dic_per20201130)
f_buy_name['주식매수1위종목_202012'] = f_buy_name['주식매수1위종목_202012'].replace(dic_per20201230)
f_buy_name['주식매수1위종목_202101'] = f_buy_name['주식매수1위종목_202101'].replace(dic_per20210129)
f_buy_name['주식매수1위종목_202102'] = f_buy_name['주식매수1위종목_202102'].replace(dic_per20210226)
f_buy_name['주식매수1위종목_202103'] = f_buy_name['주식매수1위종목_202103'].replace(dic_per20210331)
f_buy_name['주식매수1위종목_202104'] = f_buy_name['주식매수1위종목_202104'].replace(dic_per20210430)
f_buy_name['주식매수1위종목_202105'] = f_buy_name['주식매수1위종목_202105'].replace(dic_per20210531)

f_buy_name = f_buy_name.fillna(0)
f_buy_name = f_buy_name.apply(pd.to_numeric, errors = 'coerce')
f_buy_name = f_buy_name.fillna(0)

blink = np.empty(shape=1)

for i in f_buy_name.nunique().index:
    unique = f_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
s_buy_name['주식매수2위종목_202006'] = s_buy_name['주식매수2위종목_202006'].replace(dic_per20200630)
s_buy_name['주식매수2위종목_202007'] = s_buy_name['주식매수2위종목_202007'].replace(dic_per20200731)
s_buy_name['주식매수2위종목_202008'] = s_buy_name['주식매수2위종목_202008'].replace(dic_per20200831)
s_buy_name['주식매수2위종목_202009'] = s_buy_name['주식매수2위종목_202009'].replace(dic_per20200929)
s_buy_name['주식매수2위종목_202010'] = s_buy_name['주식매수2위종목_202010'].replace(dic_per20201030)
s_buy_name['주식매수2위종목_202011'] = s_buy_name['주식매수2위종목_202011'].replace(dic_per20201130)
s_buy_name['주식매수2위종목_202012'] = s_buy_name['주식매수2위종목_202012'].replace(dic_per20201230)
s_buy_name['주식매수2위종목_202101'] = s_buy_name['주식매수2위종목_202101'].replace(dic_per20210129)
s_buy_name['주식매수2위종목_202102'] = s_buy_name['주식매수2위종목_202102'].replace(dic_per20210226)
s_buy_name['주식매수2위종목_202103'] = s_buy_name['주식매수2위종목_202103'].replace(dic_per20210331)
s_buy_name['주식매수2위종목_202104'] = s_buy_name['주식매수2위종목_202104'].replace(dic_per20210430)
s_buy_name['주식매수2위종목_202105'] = s_buy_name['주식매수2위종목_202105'].replace(dic_per20210531)

s_buy_name = s_buy_name.fillna(0)
s_buy_name = s_buy_name.apply(pd.to_numeric, errors = 'coerce')
s_buy_name = s_buy_name.fillna(0)

blink = np.empty(shape=1)

for i in s_buy_name.nunique().index:
    unique = s_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
t_buy_name['주식매수3위종목_202006'] = t_buy_name['주식매수3위종목_202006'].replace(dic_per20200630)
t_buy_name['주식매수3위종목_202007'] = t_buy_name['주식매수3위종목_202007'].replace(dic_per20200731)
t_buy_name['주식매수3위종목_202008'] = t_buy_name['주식매수3위종목_202008'].replace(dic_per20200831)
t_buy_name['주식매수3위종목_202009'] = t_buy_name['주식매수3위종목_202009'].replace(dic_per20200929)
t_buy_name['주식매수3위종목_202010'] = t_buy_name['주식매수3위종목_202010'].replace(dic_per20201030)
t_buy_name['주식매수3위종목_202011'] = t_buy_name['주식매수3위종목_202011'].replace(dic_per20201130)
t_buy_name['주식매수3위종목_202012'] = t_buy_name['주식매수3위종목_202012'].replace(dic_per20201230)
t_buy_name['주식매수3위종목_202101'] = t_buy_name['주식매수3위종목_202101'].replace(dic_per20210129)
t_buy_name['주식매수3위종목_202102'] = t_buy_name['주식매수3위종목_202102'].replace(dic_per20210226)
t_buy_name['주식매수3위종목_202103'] = t_buy_name['주식매수3위종목_202103'].replace(dic_per20210331)
t_buy_name['주식매수3위종목_202104'] = t_buy_name['주식매수3위종목_202104'].replace(dic_per20210430)
t_buy_name['주식매수3위종목_202105'] = t_buy_name['주식매수3위종목_202105'].replace(dic_per20210531)

t_buy_name = t_buy_name.fillna(0)
t_buy_name = t_buy_name.apply(pd.to_numeric, errors = 'coerce')
t_buy_name = t_buy_name.fillna(0)

blink = np.empty(shape=1)

for i in t_buy_name.nunique().index:
    unique = t_buy_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
f_sell_name['주식매도1위종목_202006'] = f_sell_name['주식매도1위종목_202006'].replace(dic_per20200630)
f_sell_name['주식매도1위종목_202007'] = f_sell_name['주식매도1위종목_202007'].replace(dic_per20200731)
f_sell_name['주식매도1위종목_202008'] = f_sell_name['주식매도1위종목_202008'].replace(dic_per20200831)
f_sell_name['주식매도1위종목_202009'] = f_sell_name['주식매도1위종목_202009'].replace(dic_per20200929)
f_sell_name['주식매도1위종목_202010'] = f_sell_name['주식매도1위종목_202010'].replace(dic_per20201030)
f_sell_name['주식매도1위종목_202011'] = f_sell_name['주식매도1위종목_202011'].replace(dic_per20201130)
f_sell_name['주식매도1위종목_202012'] = f_sell_name['주식매도1위종목_202012'].replace(dic_per20201230)
f_sell_name['주식매도1위종목_202101'] = f_sell_name['주식매도1위종목_202101'].replace(dic_per20210129)
f_sell_name['주식매도1위종목_202102'] = f_sell_name['주식매도1위종목_202102'].replace(dic_per20210226)
f_sell_name['주식매도1위종목_202103'] = f_sell_name['주식매도1위종목_202103'].replace(dic_per20210331)
f_sell_name['주식매도1위종목_202104'] = f_sell_name['주식매도1위종목_202104'].replace(dic_per20210430)
f_sell_name['주식매도1위종목_202105'] = f_sell_name['주식매도1위종목_202105'].replace(dic_per20210531)

f_sell_name = f_sell_name.fillna(0)
f_sell_name = f_sell_name.apply(pd.to_numeric, errors = 'coerce')
f_sell_name = f_sell_name.fillna(0)

blink = np.empty(shape=1)

for i in f_sell_name.nunique().index:
    unique = f_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
s_sell_name['주식매도2위종목_202006'] = s_sell_name['주식매도2위종목_202006'].replace(dic_per20200630)
s_sell_name['주식매도2위종목_202007'] = s_sell_name['주식매도2위종목_202007'].replace(dic_per20200731)
s_sell_name['주식매도2위종목_202008'] = s_sell_name['주식매도2위종목_202008'].replace(dic_per20200831)
s_sell_name['주식매도2위종목_202009'] = s_sell_name['주식매도2위종목_202009'].replace(dic_per20200929)
s_sell_name['주식매도2위종목_202010'] = s_sell_name['주식매도2위종목_202010'].replace(dic_per20201030)
s_sell_name['주식매도2위종목_202011'] = s_sell_name['주식매도2위종목_202011'].replace(dic_per20201130)
s_sell_name['주식매도2위종목_202012'] = s_sell_name['주식매도2위종목_202012'].replace(dic_per20201230)
s_sell_name['주식매도2위종목_202101'] = s_sell_name['주식매도2위종목_202101'].replace(dic_per20210129)
s_sell_name['주식매도2위종목_202102'] = s_sell_name['주식매도2위종목_202102'].replace(dic_per20210226)
s_sell_name['주식매도2위종목_202103'] = s_sell_name['주식매도2위종목_202103'].replace(dic_per20210331)
s_sell_name['주식매도2위종목_202104'] = s_sell_name['주식매도2위종목_202104'].replace(dic_per20210430)
s_sell_name['주식매도2위종목_202105'] = s_sell_name['주식매도2위종목_202105'].replace(dic_per20210531)

s_sell_name = s_sell_name.fillna(0)
s_sell_name = s_sell_name.apply(pd.to_numeric, errors = 'coerce')
s_sell_name = s_sell_name.fillna(0)

blink = np.empty(shape=1)

for i in s_sell_name.nunique().index:
    unique = s_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>

```python
t_sell_name['주식매도3위종목_202006'] = t_sell_name['주식매도3위종목_202006'].replace(dic_per20200630)
t_sell_name['주식매도3위종목_202007'] = t_sell_name['주식매도3위종목_202007'].replace(dic_per20200731)
t_sell_name['주식매도3위종목_202008'] = t_sell_name['주식매도3위종목_202008'].replace(dic_per20200831)
t_sell_name['주식매도3위종목_202009'] = t_sell_name['주식매도3위종목_202009'].replace(dic_per20200929)
t_sell_name['주식매도3위종목_202010'] = t_sell_name['주식매도3위종목_202010'].replace(dic_per20201030)
t_sell_name['주식매도3위종목_202011'] = t_sell_name['주식매도3위종목_202011'].replace(dic_per20201130)
t_sell_name['주식매도3위종목_202012'] = t_sell_name['주식매도3위종목_202012'].replace(dic_per20201230)
t_sell_name['주식매도3위종목_202101'] = t_sell_name['주식매도3위종목_202101'].replace(dic_per20210129)
t_sell_name['주식매도3위종목_202102'] = t_sell_name['주식매도3위종목_202102'].replace(dic_per20210226)
t_sell_name['주식매도3위종목_202103'] = t_sell_name['주식매도3위종목_202103'].replace(dic_per20210331)
t_sell_name['주식매도3위종목_202104'] = t_sell_name['주식매도3위종목_202104'].replace(dic_per20210430)
t_sell_name['주식매도3위종목_202105'] = t_sell_name['주식매도3위종목_202105'].replace(dic_per20210531)

t_sell_name = t_sell_name.fillna(0)
t_sell_name = t_sell_name.apply(pd.to_numeric, errors = 'coerce')
t_sell_name = t_sell_name.fillna(0)

blink = np.empty(shape=1)

for i in t_sell_name.nunique().index:
    unique = t_sell_name[i].unique()
    blink = np.hstack((blink,unique))
    
blink = blink.tolist()
set(blink)
```

<pre>
{0.0}
</pre>